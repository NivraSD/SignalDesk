{"ast":null,"code":"var _jsxFileName = \"/Users/jonathanliebowitz/Desktop/SignalDesk/frontend/src/components/NivStrategicOrchestrator.js\",\n  _s = $RefreshSig$();\n// NivStrategicOrchestrator.js - The NEW Niv: Strategic PR Orchestrator\n// Primary interface that controls ALL features through conversation\n// Implements the complete vision from development specification\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Bot, Send, Sparkles, RefreshCw } from 'lucide-react';\nimport supabaseApiService from '../services/supabaseApiService';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst NivStrategicOrchestrator = ({\n  // Feature Control Props\n  onFeatureOpen,\n  onContentGenerate,\n  onStrategicPlanGenerate,\n  onWorkCardCreate,\n  // Message State Props\n  messages,\n  setMessages\n}) => {\n  _s();\n  // === CORE STATE ===\n  const [input, setInput] = useState('');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [clientMode, setClientMode] = useState('NORMAL');\n\n  // === REAL-TIME FEATURE CONTROL ===\n  const [isGeneratingInFeature, setIsGeneratingInFeature] = useState(false);\n  const [featureGenerationProgress, setFeatureGenerationProgress] = useState('');\n  const messagesEndRef = useRef(null);\n  const inputRef = useRef(null);\n\n  // === CONSULTATION MODE DETECTION (Enhanced for comprehensive PR strategist) ===\n  const detectConsultationMode = useCallback(message => {\n    const lowerMessage = message.toLowerCase();\n    const urgencyWords = ['urgent', 'crisis', 'emergency', 'breaking', 'immediate', 'asap', 'now'];\n    const analysisWords = ['analyze', 'review', 'evaluate', 'assess', 'thoughts on', 'opinion', 'what do you think'];\n    const advisoryWords = ['advice', 'recommend', 'should i', 'help me decide', 'strategy', 'approach'];\n    const reviewWords = ['feedback', 'review this', 'look at', 'check this', 'improve'];\n    const materialWords = ['create', 'write', 'draft', 'generate', 'make', 'develop'];\n\n    // Crisis Response - highest priority\n    if (urgencyWords.some(word => lowerMessage.includes(word)) && (lowerMessage.includes('crisis') || lowerMessage.includes('emergency') || lowerMessage.includes('breaking'))) {\n      return 'CRISIS_RESPONSE';\n    }\n\n    // Review Mode - when reviewing existing materials\n    if (reviewWords.some(word => lowerMessage.includes(word)) || lowerMessage.includes('attached') || lowerMessage.includes('here is') || lowerMessage.includes('this is')) {\n      return 'REVIEW_MODE';\n    }\n\n    // Material Creation - explicit creation requests\n    if (materialWords.some(word => lowerMessage.includes(word))) {\n      return 'MATERIAL_CREATION';\n    }\n\n    // Analysis Mode - analytical requests\n    if (analysisWords.some(word => lowerMessage.includes(word))) {\n      return 'ANALYSIS_MODE';\n    }\n\n    // Advisory Mode - strategic guidance requests (default)\n    return 'ADVISORY_MODE';\n  }, []);\n\n  // === IMPROVED FEATURE DETECTION ===\n  const detectFeatureIntent = useCallback(message => {\n    const lowerMessage = message.toLowerCase();\n\n    // Only detect features when user uses creation language\n    const hasCreationIntent = ['create', 'write', 'draft', 'generate', 'make', 'develop'].some(word => lowerMessage.includes(word));\n    if (!hasCreationIntent) {\n      console.log('ðŸš« No creation intent detected - not triggering features');\n      return null;\n    }\n\n    // Strategic planning patterns (only with creation intent)\n    if (lowerMessage.includes('strategic plan') || lowerMessage.includes('strategy') || lowerMessage.includes('framework') || lowerMessage.includes('roadmap')) {\n      return 'strategic-planning';\n    }\n\n    // Content generation patterns (specific content types only)\n    if (lowerMessage.includes('press release') || lowerMessage.includes('content')) {\n      return 'content-generator';\n    }\n\n    // Media intelligence patterns\n    if (lowerMessage.includes('media list') || lowerMessage.includes('media plan')) {\n      return 'media-intelligence';\n    }\n    console.log('ðŸ¤” Creation intent detected but no specific feature match');\n    return null;\n  }, []);\n\n  // === FEATURE ORCHESTRATION FUNCTIONS ===\n  const initiateContentGeneration = useCallback(async (userMessage, consultationMode) => {\n    if (!onContentGenerate) return;\n    setIsGeneratingInFeature(true);\n    setFeatureGenerationProgress('Analyzing content requirements...');\n    try {\n      // Call Niv to generate strategic content\n      const response = await supabaseApiService.callNivChat({\n        message: userMessage,\n        context: {\n          consultationMode: consultationMode,\n          detectedFeature: 'content-generator',\n          requestType: 'content_generation'\n        },\n        mode: 'content_orchestration'\n      });\n      setFeatureGenerationProgress('Generating content strategically...');\n\n      // Trigger content generation in the feature\n      onContentGenerate({\n        type: 'press-release',\n        // Default type, Niv will guide\n        initialContent: response.response,\n        message: response.response,\n        nivGenerated: true\n      });\n      setFeatureGenerationProgress('Content ready for editing!');\n    } catch (error) {\n      console.error('Error in content generation:', error);\n    } finally {\n      setTimeout(() => {\n        setIsGeneratingInFeature(false);\n        setFeatureGenerationProgress('');\n      }, 1500);\n    }\n  }, [onContentGenerate]);\n  const initiateStrategicPlanning = useCallback(async (userMessage, consultationMode) => {\n    if (!onStrategicPlanGenerate) return;\n    setIsGeneratingInFeature(true);\n    setFeatureGenerationProgress('Analyzing strategic requirements...');\n    try {\n      var _response$strategicAn;\n      const response = await supabaseApiService.callNivChat({\n        message: userMessage,\n        context: {\n          consultationMode: consultationMode,\n          detectedFeature: 'strategic-planning',\n          requestType: 'strategic_planning'\n        },\n        mode: 'strategic_orchestration'\n      });\n      setFeatureGenerationProgress('Creating strategic framework...');\n      onStrategicPlanGenerate({\n        framework: response.response,\n        nivGenerated: true,\n        strategicInsights: ((_response$strategicAn = response.strategicAnalysis) === null || _response$strategicAn === void 0 ? void 0 : _response$strategicAn.strategicInsights) || []\n      });\n    } catch (error) {\n      console.error('Error in strategic planning:', error);\n    } finally {\n      setTimeout(() => {\n        setIsGeneratingInFeature(false);\n        setFeatureGenerationProgress('');\n      }, 1500);\n    }\n  }, [onStrategicPlanGenerate]);\n\n  // Helper to format preview content as human-readable text\n  const formatPreviewContent = content => {\n    if (!content) return '';\n\n    // If it's a string, return it directly\n    if (typeof content === 'string') {\n      return content.substring(0, 300) + (content.length > 300 ? '...' : '');\n    }\n\n    // If it has a content property (press release), show that\n    if (content.content) {\n      return content.content.substring(0, 300) + (content.content.length > 300 ? '...' : '');\n    }\n\n    // If it has a title and objective (strategy plan), format nicely\n    if (content.title && content.objective) {\n      var _content$timeline;\n      let preview = `${content.title}\\n\\nðŸ“‹ Objective: ${content.objective}\\n`;\n\n      // Add timeline milestones if present\n      if ((_content$timeline = content.timeline) !== null && _content$timeline !== void 0 && _content$timeline.milestones) {\n        preview += '\\nðŸ“… Timeline:\\n';\n        content.timeline.milestones.slice(0, 2).forEach(milestone => {\n          preview += `â€¢ Week ${milestone.week}: ${milestone.task}\\n`;\n        });\n        if (content.timeline.milestones.length > 2) {\n          preview += `...and ${content.timeline.milestones.length - 2} more milestones`;\n        }\n      }\n      return preview;\n    }\n\n    // If it's a media list, show journalists\n    if (content.journalists) {\n      let preview = `ðŸ“° Media Targets (${content.totalContacts || content.journalists.length} contacts)\\n\\n`;\n      content.journalists.slice(0, 3).forEach(j => {\n        preview += `â€¢ ${j.name} - ${j.outlet} (${j.beat})\\n`;\n      });\n      if (content.journalists.length > 3) {\n        preview += `...and ${content.journalists.length - 3} more journalists`;\n      }\n      return preview;\n    }\n\n    // Fallback: show key-value pairs nicely\n    const entries = Object.entries(content).slice(0, 5);\n    return entries.map(([key, value]) => {\n      const formattedKey = key.replace(/([A-Z])/g, ' $1').trim();\n      const capitalizedKey = formattedKey.charAt(0).toUpperCase() + formattedKey.slice(1);\n      const formattedValue = typeof value === 'object' ? '[...]' : String(value).substring(0, 50);\n      return `${capitalizedKey}: ${formattedValue}`;\n    }).join('\\n');\n  };\n\n  // Helper to get details based on work type\n  const getDetailsFromType = type => {\n    switch (type) {\n      case 'strategy-plan':\n        return {\n          'Duration': '4 weeks',\n          'Status': 'Draft',\n          'Priority': 'High'\n        };\n      case 'media-list':\n        return {\n          'Journalists': '5+',\n          'Tier 1': '3',\n          'Status': 'Ready'\n        };\n      case 'content-draft':\n        return {\n          'Length': 'Full',\n          'Status': 'Draft',\n          'Type': 'Press Release'\n        };\n      default:\n        return {};\n    }\n  };\n\n  // === MESSAGE HANDLING ===\n  const handleSendMessage = useCallback(async () => {\n    if (!input.trim() || isProcessing) return;\n    const userMessage = input.trim();\n    setInput('');\n    setIsProcessing(true);\n\n    // Auto-focus input after sending\n    setTimeout(() => {\n      var _inputRef$current;\n      (_inputRef$current = inputRef.current) === null || _inputRef$current === void 0 ? void 0 : _inputRef$current.focus();\n    }, 100);\n\n    // Detect consultation mode and feature intent\n    const consultationMode = detectConsultationMode(userMessage);\n    const detectedFeature = detectFeatureIntent(userMessage);\n    setClientMode(consultationMode);\n\n    // Add user message\n    const userMsg = {\n      id: Date.now(),\n      type: 'user',\n      content: userMessage,\n      timestamp: new Date()\n    };\n    setMessages(prev => [...prev, userMsg]);\n    try {\n      var _response$response, _response$workItems, _response$workItems2, _response$workItems3, _response$workItems4;\n      console.log('ðŸš€ Sending message to Niv:', userMessage);\n      console.log('ðŸ“ Conversation history:', messages);\n\n      // Get Niv's response with consultation mode and full conversation history\n      const response = await supabaseApiService.callNivChat({\n        message: userMessage,\n        messages: messages,\n        // Pass full conversation history\n        context: {\n          consultationMode: consultationMode,\n          detectedFeature: detectedFeature,\n          conversationPhase: 'understanding'\n        },\n        mode: 'strategic_orchestration'\n      });\n      console.log('âœ… Niv response received:', response);\n      console.log('ðŸ” [NivOrchestrator] Response details:', {\n        hasResponse: !!response.response,\n        responseLength: (_response$response = response.response) === null || _response$response === void 0 ? void 0 : _response$response.length,\n        hasWorkItems: !!response.workItems,\n        workItemsCount: ((_response$workItems = response.workItems) === null || _response$workItems === void 0 ? void 0 : _response$workItems.length) || 0,\n        workItemTypes: ((_response$workItems2 = response.workItems) === null || _response$workItems2 === void 0 ? void 0 : _response$workItems2.map(item => item.type)) || [],\n        workItemTitles: ((_response$workItems3 = response.workItems) === null || _response$workItems3 === void 0 ? void 0 : _response$workItems3.map(item => item.title)) || [],\n        hasGeneratedContent: ((_response$workItems4 = response.workItems) === null || _response$workItems4 === void 0 ? void 0 : _response$workItems4.map(item => !!item.generatedContent)) || [],\n        showWork: response.showWork\n      });\n\n      // Add Niv's response with consultation mode\n      const assistantMsg = {\n        id: Date.now() + 1,\n        type: 'assistant',\n        content: response.response || 'I received your message but had trouble generating a response. Please try again.',\n        timestamp: new Date(),\n        mode: consultationMode,\n        consultationMode: response.consultationMode || consultationMode,\n        strategicAnalysis: response.strategicAnalysis\n      };\n      setMessages(prev => [...prev, assistantMsg]);\n\n      // If Niv created work items, send them ONLY to the right panel (NOT in chat)\n      if (response.workItems && response.workItems.length > 0) {\n        console.log('ðŸ“¦ [NivOrchestrator] Processing work items for RIGHT PANEL ONLY:', response.workItems);\n\n        // REMOVED: Creating work-card messages in chat\n        // Work items should ONLY appear in right panel, not as chat messages\n\n        // Send to right panel artifacts ONLY\n        setTimeout(() => {\n          // Only notify parent component for right panel artifacts\n          if (onWorkCardCreate) {\n            console.log('ðŸŽ¯ [NivOrchestrator] Calling onWorkCardCreate for parent component');\n            response.workItems.forEach((item, index) => {\n              console.log(`ðŸŽ¯ [NivOrchestrator] Sending work item ${index} to parent:`, {\n                type: item.type,\n                title: item.title,\n                hasGeneratedContent: !!item.generatedContent\n              });\n              // FIXED: Use unified structure - no double nesting\n              onWorkCardCreate({\n                type: item.type,\n                title: item.title,\n                description: item.description,\n                generatedContent: item.generatedContent,\n                details: getDetailsFromType(item.type)\n              });\n            });\n          } else {\n            console.log('âš ï¸ [NivOrchestrator] No onWorkCardCreate callback provided');\n          }\n        }, 500);\n      }\n    } catch (error) {\n      console.error('Error sending message:', error);\n      const errorMsg = {\n        id: Date.now() + 1,\n        type: 'assistant',\n        content: 'I apologize - I encountered an issue. Let me help you in a different way. What would you like to work on?',\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, errorMsg]);\n    } finally {\n      setIsProcessing(false);\n      // Re-focus input after processing\n      setTimeout(() => {\n        var _inputRef$current2;\n        (_inputRef$current2 = inputRef.current) === null || _inputRef$current2 === void 0 ? void 0 : _inputRef$current2.focus();\n      }, 100);\n    }\n  }, [input, isProcessing, detectConsultationMode, detectFeatureIntent, setMessages, messages, onWorkCardCreate]);\n  const handleKeyPress = useCallback(e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  }, [handleSendMessage]);\n\n  // Auto-scroll to bottom\n  useEffect(() => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages]);\n\n  // Focus input on mount\n  useEffect(() => {\n    var _inputRef$current3;\n    (_inputRef$current3 = inputRef.current) === null || _inputRef$current3 === void 0 ? void 0 : _inputRef$current3.focus();\n  }, []);\n\n  // === COMPONENT RENDER ===\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      height: 'calc(100% - 40px)',\n      // Add spacing from bottom\n      width: '55%',\n      // Reduced from 70% (about 25% reduction)\n      margin: '0 auto',\n      marginBottom: '20px',\n      // Space from bottom\n      display: 'flex',\n      flexDirection: 'column',\n      background: 'rgba(0, 0, 0, 0.95)',\n      color: '#e8e8e8',\n      borderRadius: '12px',\n      boxShadow: '0 8px 32px rgba(0, 0, 0, 0.4)',\n      border: '1px solid rgba(59, 130, 246, 0.2)'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '1rem',\n        borderBottom: '1px solid rgba(255, 255, 255, 0.1)',\n        background: 'rgba(59, 130, 246, 0.1)',\n        display: 'flex',\n        alignItems: 'center',\n        gap: '0.75rem'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: '40px',\n          height: '40px',\n          background: 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',\n          borderRadius: '8px',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          position: 'relative'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Bot, {\n          size: 20,\n          color: \"white\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            top: '-2px',\n            right: '-2px',\n            width: '12px',\n            height: '12px',\n            background: '#10b981',\n            borderRadius: '50%',\n            border: '2px solid rgba(0, 0, 0, 0.95)'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 430,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: '600',\n            fontSize: '16px',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '0.5rem'\n          },\n          children: [\"Niv \\u2022 Senior PR Strategist\", clientMode !== 'ADVISORY_MODE' && /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              padding: '0.25rem 0.5rem',\n              borderRadius: '4px',\n              fontSize: '11px',\n              fontWeight: '500',\n              background: clientMode === 'CRISIS_RESPONSE' ? 'rgba(239, 68, 68, 0.2)' : clientMode === 'REVIEW_MODE' ? 'rgba(245, 158, 11, 0.2)' : clientMode === 'ANALYSIS_MODE' ? 'rgba(139, 92, 246, 0.2)' : clientMode === 'MATERIAL_CREATION' ? 'rgba(16, 185, 129, 0.2)' : 'rgba(59, 130, 246, 0.2)',\n              color: clientMode === 'CRISIS_RESPONSE' ? '#ef4444' : clientMode === 'REVIEW_MODE' ? '#f59e0b' : clientMode === 'ANALYSIS_MODE' ? '#8b5cf6' : clientMode === 'MATERIAL_CREATION' ? '#10b981' : '#3b82f6'\n            },\n            children: clientMode === 'CRISIS_RESPONSE' ? 'ðŸš¨ Crisis Response' : clientMode === 'REVIEW_MODE' ? 'ðŸ“‹ Review Mode' : clientMode === 'ANALYSIS_MODE' ? 'ðŸ“Š Analysis Mode' : clientMode === 'MATERIAL_CREATION' ? 'âœ¨ Creating Materials' : 'ðŸŽ¯ Strategic Advisory'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 451,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '12px',\n            color: '#9ca3af',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '0.25rem'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Sparkles, {\n            size: 12\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 13\n          }, this), \"Comprehensive PR strategist \\u2022 Advisory \\u2022 Analysis \\u2022 Crisis \\u2022 Review \\u2022 Creation\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 477,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 7\n    }, this), (isProcessing || isGeneratingInFeature) && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '1rem',\n        background: 'linear-gradient(90deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%)',\n        borderBottom: '1px solid rgba(59, 130, 246, 0.2)',\n        display: 'flex',\n        alignItems: 'center',\n        gap: '0.75rem',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          height: '2px',\n          width: '100%',\n          background: 'linear-gradient(90deg, transparent, #3b82f6, transparent)',\n          animation: 'shimmer 2s infinite'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 503,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          animation: 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',\n          display: 'flex',\n          alignItems: 'center'\n        },\n        children: /*#__PURE__*/_jsxDEV(Sparkles, {\n          size: 16,\n          color: \"#3b82f6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 518,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 513,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: '500',\n            color: '#3b82f6'\n          },\n          children: isGeneratingInFeature ? 'Niv is working in the feature...' : 'Niv is thinking...'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 521,\n          columnNumber: 13\n        }, this), featureGenerationProgress && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '12px',\n            color: '#60a5fa'\n          },\n          children: featureGenerationProgress\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 525,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 520,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 492,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        overflowY: 'auto',\n        padding: '1rem',\n        display: 'flex',\n        flexDirection: 'column',\n        gap: '1rem'\n      },\n      children: [messages.map(message => message.type === 'work-card' ?\n      /*#__PURE__*/\n      // Inline Work Card\n      _jsxDEV(\"div\", {\n        style: {\n          background: 'linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.05) 100%)',\n          border: '1px solid rgba(99, 102, 241, 0.3)',\n          borderRadius: '12px',\n          padding: '16px',\n          marginLeft: '60px',\n          marginRight: '20%',\n          animation: 'slideIn 0.5s ease-out'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: '12px',\n            marginBottom: '12px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '36px',\n              height: '36px',\n              background: 'linear-gradient(135deg, #6366f1, #8b5cf6)',\n              borderRadius: '8px',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center'\n            },\n            children: /*#__PURE__*/_jsxDEV(Sparkles, {\n              size: 18,\n              color: \"white\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 569,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 560,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              flex: 1\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '14px',\n                fontWeight: '600',\n                color: '#fff'\n              },\n              children: message.workCard.data.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 572,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '12px',\n                color: '#8b5cf6'\n              },\n              children: \"Created by Niv \\u2022 Click to open in workspace\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 575,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 571,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 554,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '13px',\n            color: '#e0e0e0',\n            lineHeight: '1.5',\n            marginBottom: '12px'\n          },\n          children: message.workCard.data.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 580,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '12px',\n            background: 'rgba(139, 92, 246, 0.1)',\n            border: '1px solid rgba(139, 92, 246, 0.3)',\n            borderRadius: '8px',\n            fontSize: '12px',\n            color: '#a78bfa',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '8px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Sparkles, {\n            size: 14\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 599,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u2705 Generated and ready to edit in workspace \\u2192 Check right panel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 600,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 588,\n          columnNumber: 15\n        }, this)]\n      }, message.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 545,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: message.type === 'user' ? 'flex-end' : 'flex-start'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            maxWidth: '80%',\n            padding: '0.75rem 1rem',\n            borderRadius: '12px',\n            background: message.type === 'user' ? 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)' : 'rgba(255, 255, 255, 0.08)',\n            color: message.type === 'user' ? 'white' : '#e8e8e8'\n          },\n          children: [message.type === 'assistant' && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              alignItems: 'center',\n              gap: '0.5rem',\n              marginBottom: '0.5rem',\n              fontSize: '12px',\n              color: '#9ca3af'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Bot, {\n              size: 14\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 629,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                fontWeight: '500'\n              },\n              children: \"Niv\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 630,\n              columnNumber: 19\n            }, this), message.mode && /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                padding: '0.125rem 0.375rem',\n                background: 'rgba(59, 130, 246, 0.2)',\n                color: '#60a5fa',\n                borderRadius: '4px',\n                fontSize: '10px'\n              },\n              children: message.mode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 632,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 621,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              whiteSpace: 'pre-wrap',\n              lineHeight: '1.5'\n            },\n            children: message.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 644,\n            columnNumber: 15\n          }, this), message.timestamp && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '10px',\n              opacity: 0.7,\n              marginTop: '0.5rem'\n            },\n            children: new Date(message.timestamp).toLocaleTimeString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 648,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 611,\n          columnNumber: 13\n        }, this)\n      }, message.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 604,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 660,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 534,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '1rem',\n        borderTop: '1px solid rgba(255, 255, 255, 0.1)',\n        background: 'rgba(0, 0, 0, 0.5)',\n        display: 'flex',\n        gap: '0.75rem'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        ref: inputRef,\n        value: input,\n        onChange: e => setInput(e.target.value),\n        onKeyPress: handleKeyPress,\n        placeholder: \"Ask Niv for strategic advice, crisis response, material review, analysis, or content creation...\",\n        style: {\n          flex: 1,\n          padding: '0.75rem 1rem',\n          background: 'rgba(255, 255, 255, 0.05)',\n          border: '1px solid rgba(255, 255, 255, 0.1)',\n          borderRadius: '8px',\n          color: '#e8e8e8',\n          fontSize: '14px',\n          outline: 'none',\n          resize: 'vertical',\n          minHeight: '50px',\n          maxHeight: '150px',\n          fontFamily: 'inherit',\n          lineHeight: '1.5'\n        },\n        disabled: isProcessing,\n        onFocus: e => e.target.style.borderColor = 'rgba(59, 130, 246, 0.5)',\n        onBlur: e => e.target.style.borderColor = 'rgba(255, 255, 255, 0.1)'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 671,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSendMessage,\n        disabled: !input.trim() || isProcessing,\n        style: {\n          padding: '0.75rem 1.25rem',\n          borderRadius: '8px',\n          border: 'none',\n          background: !input.trim() || isProcessing ? 'rgba(255, 255, 255, 0.1)' : 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',\n          color: !input.trim() || isProcessing ? '#6b7280' : 'white',\n          cursor: !input.trim() || isProcessing ? 'not-allowed' : 'pointer',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '0.5rem',\n          fontSize: '14px',\n          fontWeight: '500',\n          transition: 'all 0.2s',\n          position: 'relative'\n        },\n        children: isProcessing ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(RefreshCw, {\n            size: 16,\n            style: {\n              animation: 'spin 1s linear infinite',\n              opacity: 0.7\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 719,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              opacity: 0.8\n            },\n            children: \"Thinking...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 720,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Send, {\n            size: 16\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 724,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 725,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 696,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 664,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        @keyframes shimmer {\n          0% { transform: translateX(-100%); }\n          100% { transform: translateX(100%); }\n        }\n        @keyframes pulse {\n          0%, 100% { opacity: 1; }\n          50% { opacity: 0.5; }\n        }\n        @keyframes slideIn {\n          from { \n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 731,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 397,\n    columnNumber: 5\n  }, this);\n};\n_s(NivStrategicOrchestrator, \"Lu+ls+tj/G02+aGf/pQpK0BUEko=\");\n_c = NivStrategicOrchestrator;\nexport default NivStrategicOrchestrator;\nvar _c;\n$RefreshReg$(_c, \"NivStrategicOrchestrator\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","Bot","Send","Sparkles","RefreshCw","supabaseApiService","jsxDEV","_jsxDEV","Fragment","_Fragment","NivStrategicOrchestrator","onFeatureOpen","onContentGenerate","onStrategicPlanGenerate","onWorkCardCreate","messages","setMessages","_s","input","setInput","isProcessing","setIsProcessing","clientMode","setClientMode","isGeneratingInFeature","setIsGeneratingInFeature","featureGenerationProgress","setFeatureGenerationProgress","messagesEndRef","inputRef","detectConsultationMode","message","lowerMessage","toLowerCase","urgencyWords","analysisWords","advisoryWords","reviewWords","materialWords","some","word","includes","detectFeatureIntent","hasCreationIntent","console","log","initiateContentGeneration","userMessage","consultationMode","response","callNivChat","context","detectedFeature","requestType","mode","type","initialContent","nivGenerated","error","setTimeout","initiateStrategicPlanning","_response$strategicAn","framework","strategicInsights","strategicAnalysis","formatPreviewContent","content","substring","length","title","objective","_content$timeline","preview","timeline","milestones","slice","forEach","milestone","week","task","journalists","totalContacts","j","name","outlet","beat","entries","Object","map","key","value","formattedKey","replace","trim","capitalizedKey","charAt","toUpperCase","formattedValue","String","join","getDetailsFromType","handleSendMessage","_inputRef$current","current","focus","userMsg","id","Date","now","timestamp","prev","_response$response","_response$workItems","_response$workItems2","_response$workItems3","_response$workItems4","conversationPhase","hasResponse","responseLength","hasWorkItems","workItems","workItemsCount","workItemTypes","item","workItemTitles","hasGeneratedContent","generatedContent","showWork","assistantMsg","index","description","details","errorMsg","_inputRef$current2","handleKeyPress","e","shiftKey","preventDefault","_messagesEndRef$curre","scrollIntoView","behavior","_inputRef$current3","style","height","width","margin","marginBottom","display","flexDirection","background","color","borderRadius","boxShadow","border","children","padding","borderBottom","alignItems","gap","justifyContent","position","size","fileName","_jsxFileName","lineNumber","columnNumber","top","right","flex","fontWeight","fontSize","overflow","left","animation","overflowY","marginLeft","marginRight","workCard","data","lineHeight","maxWidth","whiteSpace","opacity","marginTop","toLocaleTimeString","ref","borderTop","onChange","target","onKeyPress","placeholder","outline","resize","minHeight","maxHeight","fontFamily","disabled","onFocus","borderColor","onBlur","onClick","cursor","transition","_c","$RefreshReg$"],"sources":["/Users/jonathanliebowitz/Desktop/SignalDesk/frontend/src/components/NivStrategicOrchestrator.js"],"sourcesContent":["// NivStrategicOrchestrator.js - The NEW Niv: Strategic PR Orchestrator\n// Primary interface that controls ALL features through conversation\n// Implements the complete vision from development specification\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { \n  Bot, Send, Sparkles, RefreshCw\n} from 'lucide-react';\nimport supabaseApiService from '../services/supabaseApiService';\n\nconst NivStrategicOrchestrator = ({ \n  // Feature Control Props\n  onFeatureOpen,\n  onContentGenerate,\n  onStrategicPlanGenerate,\n  onWorkCardCreate,\n  \n  // Message State Props\n  messages,\n  setMessages\n}) => {\n  // === CORE STATE ===\n  const [input, setInput] = useState('');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [clientMode, setClientMode] = useState('NORMAL');\n  \n  // === REAL-TIME FEATURE CONTROL ===\n  const [isGeneratingInFeature, setIsGeneratingInFeature] = useState(false);\n  const [featureGenerationProgress, setFeatureGenerationProgress] = useState('');\n  \n  const messagesEndRef = useRef(null);\n  const inputRef = useRef(null);\n\n  // === CONSULTATION MODE DETECTION (Enhanced for comprehensive PR strategist) ===\n  const detectConsultationMode = useCallback((message) => {\n    const lowerMessage = message.toLowerCase();\n    const urgencyWords = ['urgent', 'crisis', 'emergency', 'breaking', 'immediate', 'asap', 'now'];\n    const analysisWords = ['analyze', 'review', 'evaluate', 'assess', 'thoughts on', 'opinion', 'what do you think'];\n    const advisoryWords = ['advice', 'recommend', 'should i', 'help me decide', 'strategy', 'approach'];\n    const reviewWords = ['feedback', 'review this', 'look at', 'check this', 'improve'];\n    const materialWords = ['create', 'write', 'draft', 'generate', 'make', 'develop'];\n    \n    // Crisis Response - highest priority\n    if (urgencyWords.some(word => lowerMessage.includes(word)) && \n        (lowerMessage.includes('crisis') || lowerMessage.includes('emergency') || lowerMessage.includes('breaking'))) {\n      return 'CRISIS_RESPONSE';\n    }\n    \n    // Review Mode - when reviewing existing materials\n    if (reviewWords.some(word => lowerMessage.includes(word)) || \n        lowerMessage.includes('attached') || lowerMessage.includes('here is') || lowerMessage.includes('this is')) {\n      return 'REVIEW_MODE';\n    }\n    \n    // Material Creation - explicit creation requests\n    if (materialWords.some(word => lowerMessage.includes(word))) {\n      return 'MATERIAL_CREATION';\n    }\n    \n    // Analysis Mode - analytical requests\n    if (analysisWords.some(word => lowerMessage.includes(word))) {\n      return 'ANALYSIS_MODE';\n    }\n    \n    // Advisory Mode - strategic guidance requests (default)\n    return 'ADVISORY_MODE';\n  }, []);\n\n  // === IMPROVED FEATURE DETECTION ===\n  const detectFeatureIntent = useCallback((message) => {\n    const lowerMessage = message.toLowerCase();\n    \n    // Only detect features when user uses creation language\n    const hasCreationIntent = ['create', 'write', 'draft', 'generate', 'make', 'develop'].some(word => \n      lowerMessage.includes(word)\n    );\n    \n    if (!hasCreationIntent) {\n      console.log('ðŸš« No creation intent detected - not triggering features');\n      return null;\n    }\n    \n    // Strategic planning patterns (only with creation intent)\n    if (lowerMessage.includes('strategic plan') || lowerMessage.includes('strategy') ||\n        lowerMessage.includes('framework') || lowerMessage.includes('roadmap')) {\n      return 'strategic-planning';\n    }\n    \n    // Content generation patterns (specific content types only)\n    if (lowerMessage.includes('press release') || lowerMessage.includes('content')) {\n      return 'content-generator';\n    }\n    \n    // Media intelligence patterns\n    if (lowerMessage.includes('media list') || lowerMessage.includes('media plan')) {\n      return 'media-intelligence';\n    }\n    \n    console.log('ðŸ¤” Creation intent detected but no specific feature match');\n    return null;\n  }, []);\n\n  // === FEATURE ORCHESTRATION FUNCTIONS ===\n  const initiateContentGeneration = useCallback(async (userMessage, consultationMode) => {\n    if (!onContentGenerate) return;\n    \n    setIsGeneratingInFeature(true);\n    setFeatureGenerationProgress('Analyzing content requirements...');\n    \n    try {\n      // Call Niv to generate strategic content\n      const response = await supabaseApiService.callNivChat({\n        message: userMessage,\n        context: {\n          consultationMode: consultationMode,\n          detectedFeature: 'content-generator',\n          requestType: 'content_generation'\n        },\n        mode: 'content_orchestration'\n      });\n      \n      setFeatureGenerationProgress('Generating content strategically...');\n      \n      // Trigger content generation in the feature\n      onContentGenerate({\n        type: 'press-release', // Default type, Niv will guide\n        initialContent: response.response,\n        message: response.response,\n        nivGenerated: true\n      });\n      \n      setFeatureGenerationProgress('Content ready for editing!');\n      \n    } catch (error) {\n      console.error('Error in content generation:', error);\n    } finally {\n      setTimeout(() => {\n        setIsGeneratingInFeature(false);\n        setFeatureGenerationProgress('');\n      }, 1500);\n    }\n  }, [onContentGenerate]);\n\n  const initiateStrategicPlanning = useCallback(async (userMessage, consultationMode) => {\n    if (!onStrategicPlanGenerate) return;\n    \n    setIsGeneratingInFeature(true);\n    setFeatureGenerationProgress('Analyzing strategic requirements...');\n    \n    try {\n      const response = await supabaseApiService.callNivChat({\n        message: userMessage,\n        context: {\n          consultationMode: consultationMode,\n          detectedFeature: 'strategic-planning',\n          requestType: 'strategic_planning'\n        },\n        mode: 'strategic_orchestration'\n      });\n      \n      setFeatureGenerationProgress('Creating strategic framework...');\n      \n      onStrategicPlanGenerate({\n        framework: response.response,\n        nivGenerated: true,\n        strategicInsights: response.strategicAnalysis?.strategicInsights || []\n      });\n      \n    } catch (error) {\n      console.error('Error in strategic planning:', error);\n    } finally {\n      setTimeout(() => {\n        setIsGeneratingInFeature(false);\n        setFeatureGenerationProgress('');\n      }, 1500);\n    }\n  }, [onStrategicPlanGenerate]);\n\n  // Helper to format preview content as human-readable text\n  const formatPreviewContent = (content) => {\n    if (!content) return '';\n    \n    // If it's a string, return it directly\n    if (typeof content === 'string') {\n      return content.substring(0, 300) + (content.length > 300 ? '...' : '');\n    }\n    \n    // If it has a content property (press release), show that\n    if (content.content) {\n      return content.content.substring(0, 300) + (content.content.length > 300 ? '...' : '');\n    }\n    \n    // If it has a title and objective (strategy plan), format nicely\n    if (content.title && content.objective) {\n      let preview = `${content.title}\\n\\nðŸ“‹ Objective: ${content.objective}\\n`;\n      \n      // Add timeline milestones if present\n      if (content.timeline?.milestones) {\n        preview += '\\nðŸ“… Timeline:\\n';\n        content.timeline.milestones.slice(0, 2).forEach(milestone => {\n          preview += `â€¢ Week ${milestone.week}: ${milestone.task}\\n`;\n        });\n        if (content.timeline.milestones.length > 2) {\n          preview += `...and ${content.timeline.milestones.length - 2} more milestones`;\n        }\n      }\n      \n      return preview;\n    }\n    \n    // If it's a media list, show journalists\n    if (content.journalists) {\n      let preview = `ðŸ“° Media Targets (${content.totalContacts || content.journalists.length} contacts)\\n\\n`;\n      content.journalists.slice(0, 3).forEach(j => {\n        preview += `â€¢ ${j.name} - ${j.outlet} (${j.beat})\\n`;\n      });\n      if (content.journalists.length > 3) {\n        preview += `...and ${content.journalists.length - 3} more journalists`;\n      }\n      return preview;\n    }\n    \n    // Fallback: show key-value pairs nicely\n    const entries = Object.entries(content).slice(0, 5);\n    return entries.map(([key, value]) => {\n      const formattedKey = key.replace(/([A-Z])/g, ' $1').trim();\n      const capitalizedKey = formattedKey.charAt(0).toUpperCase() + formattedKey.slice(1);\n      const formattedValue = typeof value === 'object' ? '[...]' : String(value).substring(0, 50);\n      return `${capitalizedKey}: ${formattedValue}`;\n    }).join('\\n');\n  };\n\n  // Helper to get details based on work type\n  const getDetailsFromType = (type) => {\n    switch(type) {\n      case 'strategy-plan':\n        return {\n          'Duration': '4 weeks',\n          'Status': 'Draft',\n          'Priority': 'High'\n        };\n      case 'media-list':\n        return {\n          'Journalists': '5+',\n          'Tier 1': '3',\n          'Status': 'Ready'\n        };\n      case 'content-draft':\n        return {\n          'Length': 'Full',\n          'Status': 'Draft',\n          'Type': 'Press Release'\n        };\n      default:\n        return {};\n    }\n  };\n\n  // === MESSAGE HANDLING ===\n  const handleSendMessage = useCallback(async () => {\n    if (!input.trim() || isProcessing) return;\n    \n    const userMessage = input.trim();\n    setInput('');\n    setIsProcessing(true);\n    \n    // Auto-focus input after sending\n    setTimeout(() => {\n      inputRef.current?.focus();\n    }, 100);\n    \n    // Detect consultation mode and feature intent\n    const consultationMode = detectConsultationMode(userMessage);\n    const detectedFeature = detectFeatureIntent(userMessage);\n    \n    setClientMode(consultationMode);\n    \n    // Add user message\n    const userMsg = {\n      id: Date.now(),\n      type: 'user',\n      content: userMessage,\n      timestamp: new Date()\n    };\n    setMessages(prev => [...prev, userMsg]);\n    \n    try {\n      console.log('ðŸš€ Sending message to Niv:', userMessage);\n      console.log('ðŸ“ Conversation history:', messages);\n      \n      // Get Niv's response with consultation mode and full conversation history\n      const response = await supabaseApiService.callNivChat({\n        message: userMessage,\n        messages: messages, // Pass full conversation history\n        context: {\n          consultationMode: consultationMode,\n          detectedFeature: detectedFeature,\n          conversationPhase: 'understanding'\n        },\n        mode: 'strategic_orchestration'\n      });\n      \n      console.log('âœ… Niv response received:', response);\n      console.log('ðŸ” [NivOrchestrator] Response details:', {\n        hasResponse: !!response.response,\n        responseLength: response.response?.length,\n        hasWorkItems: !!response.workItems,\n        workItemsCount: response.workItems?.length || 0,\n        workItemTypes: response.workItems?.map(item => item.type) || [],\n        workItemTitles: response.workItems?.map(item => item.title) || [],\n        hasGeneratedContent: response.workItems?.map(item => !!item.generatedContent) || [],\n        showWork: response.showWork\n      });\n      \n      // Add Niv's response with consultation mode\n      const assistantMsg = {\n        id: Date.now() + 1,\n        type: 'assistant',\n        content: response.response || 'I received your message but had trouble generating a response. Please try again.',\n        timestamp: new Date(),\n        mode: consultationMode,\n        consultationMode: response.consultationMode || consultationMode,\n        strategicAnalysis: response.strategicAnalysis\n      };\n      setMessages(prev => [...prev, assistantMsg]);\n      \n      // If Niv created work items, send them ONLY to the right panel (NOT in chat)\n      if (response.workItems && response.workItems.length > 0) {\n        console.log('ðŸ“¦ [NivOrchestrator] Processing work items for RIGHT PANEL ONLY:', response.workItems);\n        \n        // REMOVED: Creating work-card messages in chat\n        // Work items should ONLY appear in right panel, not as chat messages\n        \n        // Send to right panel artifacts ONLY\n        setTimeout(() => {\n          // Only notify parent component for right panel artifacts\n          if (onWorkCardCreate) {\n            console.log('ðŸŽ¯ [NivOrchestrator] Calling onWorkCardCreate for parent component');\n            response.workItems.forEach((item, index) => {\n              console.log(`ðŸŽ¯ [NivOrchestrator] Sending work item ${index} to parent:`, {\n                type: item.type,\n                title: item.title,\n                hasGeneratedContent: !!item.generatedContent\n              });\n              // FIXED: Use unified structure - no double nesting\n              onWorkCardCreate({\n                type: item.type,\n                title: item.title,\n                description: item.description,\n                generatedContent: item.generatedContent,\n                details: getDetailsFromType(item.type)\n              });\n            });\n          } else {\n            console.log('âš ï¸ [NivOrchestrator] No onWorkCardCreate callback provided');\n          }\n        }, 500);\n      }\n      \n    } catch (error) {\n      console.error('Error sending message:', error);\n      const errorMsg = {\n        id: Date.now() + 1,\n        type: 'assistant',\n        content: 'I apologize - I encountered an issue. Let me help you in a different way. What would you like to work on?',\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, errorMsg]);\n    } finally {\n      setIsProcessing(false);\n      // Re-focus input after processing\n      setTimeout(() => {\n        inputRef.current?.focus();\n      }, 100);\n    }\n  }, [input, isProcessing, detectConsultationMode, detectFeatureIntent, setMessages, messages, onWorkCardCreate]);\n\n  const handleKeyPress = useCallback((e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  }, [handleSendMessage]);\n\n  // Auto-scroll to bottom\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [messages]);\n\n  // Focus input on mount\n  useEffect(() => {\n    inputRef.current?.focus();\n  }, []);\n\n  // === COMPONENT RENDER ===\n  return (\n    <div style={{ \n      height: 'calc(100% - 40px)', // Add spacing from bottom\n      width: '55%', // Reduced from 70% (about 25% reduction)\n      margin: '0 auto',\n      marginBottom: '20px', // Space from bottom\n      display: 'flex', \n      flexDirection: 'column',\n      background: 'rgba(0, 0, 0, 0.95)',\n      color: '#e8e8e8',\n      borderRadius: '12px',\n      boxShadow: '0 8px 32px rgba(0, 0, 0, 0.4)',\n      border: '1px solid rgba(59, 130, 246, 0.2)'\n    }}>\n      {/* Niv Header with Strategic Identity */}\n      <div style={{\n        padding: '1rem',\n        borderBottom: '1px solid rgba(255, 255, 255, 0.1)',\n        background: 'rgba(59, 130, 246, 0.1)',\n        display: 'flex',\n        alignItems: 'center',\n        gap: '0.75rem'\n      }}>\n        <div style={{\n          width: '40px',\n          height: '40px',\n          background: 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',\n          borderRadius: '8px',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          position: 'relative'\n        }}>\n          <Bot size={20} color=\"white\" />\n          <div style={{\n            position: 'absolute',\n            top: '-2px',\n            right: '-2px',\n            width: '12px',\n            height: '12px',\n            background: '#10b981',\n            borderRadius: '50%',\n            border: '2px solid rgba(0, 0, 0, 0.95)'\n          }} />\n        </div>\n        <div style={{ flex: 1 }}>\n          <div style={{ \n            fontWeight: '600', \n            fontSize: '16px',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '0.5rem'\n          }}>\n            Niv â€¢ Senior PR Strategist\n            {clientMode !== 'ADVISORY_MODE' && (\n              <span style={{\n                padding: '0.25rem 0.5rem',\n                borderRadius: '4px',\n                fontSize: '11px',\n                fontWeight: '500',\n                background: \n                  clientMode === 'CRISIS_RESPONSE' ? 'rgba(239, 68, 68, 0.2)' :\n                  clientMode === 'REVIEW_MODE' ? 'rgba(245, 158, 11, 0.2)' :\n                  clientMode === 'ANALYSIS_MODE' ? 'rgba(139, 92, 246, 0.2)' :\n                  clientMode === 'MATERIAL_CREATION' ? 'rgba(16, 185, 129, 0.2)' :\n                  'rgba(59, 130, 246, 0.2)',\n                color:\n                  clientMode === 'CRISIS_RESPONSE' ? '#ef4444' :\n                  clientMode === 'REVIEW_MODE' ? '#f59e0b' :\n                  clientMode === 'ANALYSIS_MODE' ? '#8b5cf6' :\n                  clientMode === 'MATERIAL_CREATION' ? '#10b981' :\n                  '#3b82f6'\n              }}>\n                {clientMode === 'CRISIS_RESPONSE' ? 'ðŸš¨ Crisis Response' :\n                 clientMode === 'REVIEW_MODE' ? 'ðŸ“‹ Review Mode' :\n                 clientMode === 'ANALYSIS_MODE' ? 'ðŸ“Š Analysis Mode' :\n                 clientMode === 'MATERIAL_CREATION' ? 'âœ¨ Creating Materials' :\n                 'ðŸŽ¯ Strategic Advisory'}\n              </span>\n            )}\n          </div>\n          <div style={{ \n            fontSize: '12px', \n            color: '#9ca3af',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '0.25rem'\n          }}>\n            <Sparkles size={12} />\nComprehensive PR strategist â€¢ Advisory â€¢ Analysis â€¢ Crisis â€¢ Review â€¢ Creation\n          </div>\n        </div>\n      </div>\n\n      {/* Processing Indicator */}\n      {(isProcessing || isGeneratingInFeature) && (\n        <div style={{\n          padding: '1rem',\n          background: 'linear-gradient(90deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%)',\n          borderBottom: '1px solid rgba(59, 130, 246, 0.2)',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '0.75rem',\n          position: 'relative',\n          overflow: 'hidden'\n        }}>\n          {/* Animated progress bar */}\n          <div style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            height: '2px',\n            width: '100%',\n            background: 'linear-gradient(90deg, transparent, #3b82f6, transparent)',\n            animation: 'shimmer 2s infinite'\n          }} />\n          \n          <div style={{ \n            animation: 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',\n            display: 'flex',\n            alignItems: 'center'\n          }}>\n            <Sparkles size={16} color=\"#3b82f6\" />\n          </div>\n          <div>\n            <div style={{ fontWeight: '500', color: '#3b82f6' }}>\n              {isGeneratingInFeature ? 'Niv is working in the feature...' : 'Niv is thinking...'}\n            </div>\n            {featureGenerationProgress && (\n              <div style={{ fontSize: '12px', color: '#60a5fa' }}>\n                {featureGenerationProgress}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Messages */}\n      <div style={{ \n        flex: 1, \n        overflowY: 'auto', \n        padding: '1rem',\n        display: 'flex',\n        flexDirection: 'column',\n        gap: '1rem'\n      }}>\n        {messages.map((message) => (\n          message.type === 'work-card' ? (\n            // Inline Work Card\n            <div key={message.id} style={{\n              background: 'linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.05) 100%)',\n              border: '1px solid rgba(99, 102, 241, 0.3)',\n              borderRadius: '12px',\n              padding: '16px',\n              marginLeft: '60px',\n              marginRight: '20%',\n              animation: 'slideIn 0.5s ease-out'\n            }}>\n              <div style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: '12px',\n                marginBottom: '12px'\n              }}>\n                <div style={{\n                  width: '36px',\n                  height: '36px',\n                  background: 'linear-gradient(135deg, #6366f1, #8b5cf6)',\n                  borderRadius: '8px',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center'\n                }}>\n                  <Sparkles size={18} color=\"white\" />\n                </div>\n                <div style={{ flex: 1 }}>\n                  <div style={{ fontSize: '14px', fontWeight: '600', color: '#fff' }}>\n                    {message.workCard.data.title}\n                  </div>\n                  <div style={{ fontSize: '12px', color: '#8b5cf6' }}>\n                    Created by Niv â€¢ Click to open in workspace\n                  </div>\n                </div>\n              </div>\n              <div style={{\n                fontSize: '13px',\n                color: '#e0e0e0',\n                lineHeight: '1.5',\n                marginBottom: '12px'\n              }}>\n                {message.workCard.data.description}\n              </div>\n              <div style={{\n                padding: '12px',\n                background: 'rgba(139, 92, 246, 0.1)',\n                border: '1px solid rgba(139, 92, 246, 0.3)',\n                borderRadius: '8px',\n                fontSize: '12px',\n                color: '#a78bfa',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '8px'\n              }}>\n                <Sparkles size={14} />\n                <span>âœ… Generated and ready to edit in workspace â†’ Check right panel</span>\n              </div>\n            </div>\n          ) : (\n          <div\n            key={message.id}\n            style={{\n              display: 'flex',\n              justifyContent: message.type === 'user' ? 'flex-end' : 'flex-start'\n            }}\n          >\n            <div style={{\n              maxWidth: '80%',\n              padding: '0.75rem 1rem',\n              borderRadius: '12px',\n              background: message.type === 'user' \n                ? 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)'\n                : 'rgba(255, 255, 255, 0.08)',\n              color: message.type === 'user' ? 'white' : '#e8e8e8'\n            }}>\n              {message.type === 'assistant' && (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'center', \n                  gap: '0.5rem',\n                  marginBottom: '0.5rem',\n                  fontSize: '12px',\n                  color: '#9ca3af'\n                }}>\n                  <Bot size={14} />\n                  <span style={{ fontWeight: '500' }}>Niv</span>\n                  {message.mode && (\n                    <span style={{\n                      padding: '0.125rem 0.375rem',\n                      background: 'rgba(59, 130, 246, 0.2)',\n                      color: '#60a5fa',\n                      borderRadius: '4px',\n                      fontSize: '10px'\n                    }}>\n                      {message.mode}\n                    </span>\n                  )}\n                </div>\n              )}\n              <div style={{ whiteSpace: 'pre-wrap', lineHeight: '1.5' }}>\n                {message.content}\n              </div>\n              {message.timestamp && (\n                <div style={{ \n                  fontSize: '10px', \n                  opacity: 0.7, \n                  marginTop: '0.5rem' \n                }}>\n                  {new Date(message.timestamp).toLocaleTimeString()}\n                </div>\n              )}\n            </div>\n          </div>\n          )\n        ))}\n        <div ref={messagesEndRef} />\n      </div>\n\n      {/* Strategic Input Interface */}\n      <div style={{\n        padding: '1rem',\n        borderTop: '1px solid rgba(255, 255, 255, 0.1)',\n        background: 'rgba(0, 0, 0, 0.5)',\n        display: 'flex',\n        gap: '0.75rem'\n      }}>\n        <textarea\n          ref={inputRef}\n          value={input}\n          onChange={(e) => setInput(e.target.value)}\n          onKeyPress={handleKeyPress}\n          placeholder=\"Ask Niv for strategic advice, crisis response, material review, analysis, or content creation...\"\n          style={{\n            flex: 1,\n            padding: '0.75rem 1rem',\n            background: 'rgba(255, 255, 255, 0.05)',\n            border: '1px solid rgba(255, 255, 255, 0.1)',\n            borderRadius: '8px',\n            color: '#e8e8e8',\n            fontSize: '14px',\n            outline: 'none',\n            resize: 'vertical',\n            minHeight: '50px',\n            maxHeight: '150px',\n            fontFamily: 'inherit',\n            lineHeight: '1.5'\n          }}\n          disabled={isProcessing}\n          onFocus={(e) => e.target.style.borderColor = 'rgba(59, 130, 246, 0.5)'}\n          onBlur={(e) => e.target.style.borderColor = 'rgba(255, 255, 255, 0.1)'}\n        />\n        <button\n          onClick={handleSendMessage}\n          disabled={!input.trim() || isProcessing}\n          style={{\n            padding: '0.75rem 1.25rem',\n            borderRadius: '8px',\n            border: 'none',\n            background: !input.trim() || isProcessing\n              ? 'rgba(255, 255, 255, 0.1)'\n              : 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',\n            color: !input.trim() || isProcessing ? '#6b7280' : 'white',\n            cursor: !input.trim() || isProcessing ? 'not-allowed' : 'pointer',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '0.5rem',\n            fontSize: '14px',\n            fontWeight: '500',\n            transition: 'all 0.2s',\n            position: 'relative'\n          }}\n        >\n          {isProcessing ? (\n            <>\n              <RefreshCw size={16} style={{ animation: 'spin 1s linear infinite', opacity: 0.7 }} />\n              <span style={{ opacity: 0.8 }}>Thinking...</span>\n            </>\n          ) : (\n            <>\n              <Send size={16} />\n              <span>Send</span>\n            </>\n          )}\n        </button>\n      </div>\n\n      <style>{`\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        @keyframes shimmer {\n          0% { transform: translateX(-100%); }\n          100% { transform: translateX(100%); }\n        }\n        @keyframes pulse {\n          0%, 100% { opacity: 1; }\n          50% { opacity: 0.5; }\n        }\n        @keyframes slideIn {\n          from { \n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n      `}</style>\n    </div>\n  );\n};\n\nexport default NivStrategicOrchestrator;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}