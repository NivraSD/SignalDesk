{"ast":null,"code":"import React,{useState,useEffect}from'react';import{supabase}from'../config/supabase';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DiagnosticPanel=()=>{const[diagnostics,setDiagnostics]=useState({environment:{},supabase:{},localStorage:{},orchestrator:{},apiTests:{},lastOrchestrationCall:null});const[isVisible,setIsVisible]=useState(false);useEffect(()=>{// Only show in development or with debug flag\nconst showDebug=process.env.NODE_ENV==='development'||localStorage.getItem('signaldesk_debug')==='true'||window.location.search.includes('debug=true');setIsVisible(showDebug);if(showDebug){runDiagnostics();}},[]);const runDiagnostics=async()=>{var _process$env$REACT_AP,_process$env$REACT_AP2;const diag={environment:{NODE_ENV:process.env.NODE_ENV,SUPABASE_URL:process.env.REACT_APP_SUPABASE_URL,SUPABASE_KEY_LENGTH:(_process$env$REACT_AP=process.env.REACT_APP_SUPABASE_ANON_KEY)===null||_process$env$REACT_AP===void 0?void 0:_process$env$REACT_AP.length,SUPABASE_KEY_PREFIX:(_process$env$REACT_AP2=process.env.REACT_APP_SUPABASE_ANON_KEY)===null||_process$env$REACT_AP2===void 0?void 0:_process$env$REACT_AP2.substring(0,30),BUILD_TIME:process.env.REACT_APP_BUILD_TIME||'unknown',VERCEL_ENV:process.env.VERCEL_ENV||'not-vercel'},supabase:{configured:!!supabase,url:supabase===null||supabase===void 0?void 0:supabase.supabaseUrl,hasAuth:!!(supabase!==null&&supabase!==void 0&&supabase.auth),hasRealtime:!!(supabase!==null&&supabase!==void 0&&supabase.realtime)},localStorage:{use_orchestrator:localStorage.getItem('signaldesk_use_orchestrator'),minimal_mode:localStorage.getItem('signaldesk_minimal'),cached_keys:Object.keys(localStorage).filter(k=>k.startsWith('signaldesk_')).length},orchestrator:{mode:localStorage.getItem('signaldesk_use_orchestrator')!=='false'?'enabled':'disabled',expected_flow:localStorage.getItem('signaldesk_use_orchestrator')!=='false'?'4-phase orchestration':'multi-step with personas'},apiTests:{}};// Test Supabase connection\ntry{const testUrl=\"\".concat(process.env.REACT_APP_SUPABASE_URL,\"/functions/v1/test-secrets\");const response=await fetch(testUrl,{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(process.env.REACT_APP_SUPABASE_ANON_KEY)},body:JSON.stringify({})});if(response.ok){var _data$anthropic_key,_data$anthropic_key2;const data=await response.json();diag.apiTests.secrets={status:'success',hasAnthropicKey:(_data$anthropic_key=data.anthropic_key)===null||_data$anthropic_key===void 0?void 0:_data$anthropic_key.exists,anthropicKeyLength:(_data$anthropic_key2=data.anthropic_key)===null||_data$anthropic_key2===void 0?void 0:_data$anthropic_key2.length};}else{diag.apiTests.secrets={status:'failed',error:\"HTTP \".concat(response.status),message:await response.text()};}}catch(error){diag.apiTests.secrets={status:'error',error:error.message};}// Test discovery function\ntry{const discoveryUrl=\"\".concat(process.env.REACT_APP_SUPABASE_URL,\"/functions/v1/intelligent-discovery\");const response=await fetch(discoveryUrl,{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(process.env.REACT_APP_SUPABASE_ANON_KEY)},body:JSON.stringify({organization:'Test',industry_hint:'technology'})});diag.apiTests.discovery={status:response.ok?'success':'failed',httpStatus:response.status};}catch(error){diag.apiTests.discovery={status:'error',error:error.message};}setDiagnostics(diag);};if(!isVisible)return null;return/*#__PURE__*/_jsxs(\"div\",{style:{position:'fixed',bottom:20,right:20,width:400,maxHeight:600,overflow:'auto',background:'rgba(0, 0, 0, 0.9)',color:'#0f0',padding:15,borderRadius:8,fontFamily:'monospace',fontSize:12,zIndex:99999,border:'1px solid #0f0'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:10},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,color:'#0f0'},children:\"\\uD83D\\uDD27 Diagnostics\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsVisible(false),style:{background:'none',border:'none',color:'#0f0',cursor:'pointer'},children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:10},children:[/*#__PURE__*/_jsx(\"button\",{onClick:runDiagnostics,style:{background:'#0f0',color:'#000',border:'none',padding:'5px 10px',cursor:'pointer',marginRight:10},children:\"Refresh\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{localStorage.setItem('signaldesk_use_orchestrator',localStorage.getItem('signaldesk_use_orchestrator')==='false'?'true':'false');runDiagnostics();},style:{background:'#ff0',color:'#000',border:'none',padding:'5px 10px',cursor:'pointer'},children:\"Toggle Orchestrator\"})]}),/*#__PURE__*/_jsx(\"pre\",{style:{margin:0,color:'#0f0'},children:JSON.stringify(diagnostics,null,2)}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:10,paddingTop:10,borderTop:'1px solid #0f0'},children:/*#__PURE__*/_jsxs(\"small\",{children:[\"Mode: \",diagnostics.orchestrator.mode,/*#__PURE__*/_jsx(\"br\",{}),\"Flow: \",diagnostics.orchestrator.expected_flow,/*#__PURE__*/_jsx(\"br\",{}),\"To toggle: Click button above or set localStorage\"]})})]});};export default DiagnosticPanel;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}