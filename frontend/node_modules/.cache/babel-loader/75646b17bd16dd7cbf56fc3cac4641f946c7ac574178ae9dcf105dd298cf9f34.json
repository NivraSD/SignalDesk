{"ast":null,"code":"import _objectSpread from\"/Users/jonathanliebowitz/Desktop/SignalDesk/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from\"react\";import{useProject}from\"../contexts/ProjectContext\";import{useNavigate}from\"react-router-dom\";import SaveToMemoryVaultButton from\"./MemoryVault/SaveToMemoryVaultButton\";import strategicPlanningService from'../services/strategicPlanningService';import{Brain,Target,Lightbulb,ChevronRight,ChevronDown,Download,Loader,AlertCircle,Sparkles,Calendar,BarChart3,CheckCircle,ArrowRight,Zap,TrendingUp,Users,Globe,Shield,Play,Eye,Edit3,FileText,ListChecks,Clock,Info,X,Copy,Save}from\"lucide-react\";import\"./StrategicPlanningOptimized.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function StrategicPlanningOptimized(_ref){var _strategicPlan$strate2,_strategicPlan$strate3;let{initialData,onDataChange}=_ref;const[objective,setObjective]=useState(\"\");const[context,setContext]=useState(\"\");const[constraints,setConstraints]=useState(\"\");const[timeline,setTimeline]=useState(\"\");const[isGenerating,setIsGenerating]=useState(false);const[strategicPlan,setStrategicPlan]=useState(null);const[error,setError]=useState(null);const[expandedPillars,setExpandedPillars]=useState({});const[showEvidence,setShowEvidence]=useState({});const[isExecuting,setIsExecuting]=useState(false);const[executionStatus,setExecutionStatus]=useState(null);const[savedPlans,setSavedPlans]=useState([]);const[activeTab,setActiveTab]=useState('create');const{selectedProject}=useProject();const navigate=useNavigate();// Context pills for quick starts\nconst contextPills=[{id:'launch',label:'Product Launch',icon:Sparkles,color:'#10b981'},{id:'crisis',label:'Crisis Response',icon:Shield,color:'#ef4444'},{id:'thought',label:'Thought Leadership',icon:Brain,color:'#8b5cf6'},{id:'market',label:'Market Entry',icon:Globe,color:'#3b82f6'},{id:'reputation',label:'Reputation Building',icon:TrendingUp,color:'#f59e0b'}];const planningTypes=[{id:'comprehensive',label:'Comprehensive',icon:Brain,desc:'Full strategic plan'},{id:'crisis',label:'Crisis Response',icon:Shield,desc:'Rapid response plan'},{id:'campaign',label:'Campaign',icon:Target,desc:'Focused campaign'},{id:'launch',label:'Product Launch',icon:Sparkles,desc:'Go-to-market plan'}];const[selectedPlanType,setSelectedPlanType]=useState('comprehensive');const tabs=[{id:'create',label:'Create Plan',icon:Brain},{id:'current',label:'Current Plan',icon:FileText},{id:'saved',label:'Saved Plans',icon:Save},{id:'history',label:'Analytics',icon:BarChart3}];useEffect(()=>{loadSavedPlans();},[]);// Handle initial data from Niv\nuseEffect(()=>{if(initialData){setObjective(initialData.objective||'');setContext(initialData.context||'');setConstraints(initialData.constraints||'');setTimeline(initialData.timeline||'');// Set plan type if provided\nif(initialData.planType){setSelectedPlanType(initialData.planType);}// Auto-generate if all required data is present\nif(initialData.objective&&initialData.autoGenerate){generateStrategicPlan();}}},[initialData]);const loadSavedPlans=()=>{const plans=strategicPlanningService.getPlansFromLocalStorage();setSavedPlans(plans);};const togglePillar=pillarId=>{setExpandedPillars(prev=>_objectSpread(_objectSpread({},prev),{},{[pillarId]:!prev[pillarId]}));};const generateStrategicPlan=async()=>{if(!objective.trim()){setError(\"Please describe your objective\");return;}setIsGenerating(true);setError(null);try{const result=await strategicPlanningService.generatePlan(objective,context,constraints,timeline);if(!result||!result.success&&!result.data){throw new Error(\"Failed to generate strategic plan\");}const plan=result.data||result;setStrategicPlan(plan);strategicPlanningService.savePlanToLocalStorage(plan);loadSavedPlans();if(plan.strategic_pillars&&plan.strategic_pillars.length>0){setExpandedPillars({0:true});}// Switch to current plan tab to show the generated plan\nsetActiveTab('current');}catch(error){console.error(\"Error generating strategic plan:\",error);setError(error.message||\"Failed to generate strategic plan\");}finally{setIsGenerating(false);}};const copyPlanToClipboard=()=>{var _strategicPlan$strate,_strategicPlan$implem,_strategicPlan$succes;if(!strategicPlan)return;const planText=\"\\nSTRATEGIC PLAN: \".concat(strategicPlan.objective,\"\\n\\nEXECUTIVE SUMMARY:\\n\").concat(strategicPlan.executive_summary,\"\\n\\nSTRATEGIC PILLARS:\\n\").concat((_strategicPlan$strate=strategicPlan.strategic_pillars)===null||_strategicPlan$strate===void 0?void 0:_strategicPlan$strate.map((pillar,index)=>{var _pillar$actions;return\"\".concat(index+1,\". \").concat(pillar.title,\"\\n     \").concat(pillar.description,\"\\n     Actions: \").concat(((_pillar$actions=pillar.actions)===null||_pillar$actions===void 0?void 0:_pillar$actions.join(', '))||'Not specified',\"\\n     Timeline: \").concat(pillar.timeline||'TBD',\"\\n     MCP Assignment: \").concat(pillar.mcp||'Not assigned');}).join('\\n\\n'),\"\\n\\nIMPLEMENTATION PHASES:\\n\").concat((_strategicPlan$implem=strategicPlan.implementation_phases)===null||_strategicPlan$implem===void 0?void 0:_strategicPlan$implem.map(phase=>{var _phase$tasks;return\"\\u2022 \".concat(phase.phase,\": \").concat(phase.duration,\" - \").concat((_phase$tasks=phase.tasks)===null||_phase$tasks===void 0?void 0:_phase$tasks.join(', '));}).join('\\n'),\"\\n\\nSUCCESS METRICS:\\n\").concat((_strategicPlan$succes=strategicPlan.success_metrics)===null||_strategicPlan$succes===void 0?void 0:_strategicPlan$succes.map(metric=>\"\\u2022 \".concat(metric)).join('\\n'),\"\\n    \").trim();navigator.clipboard.writeText(planText);};const executeStrategicPlan=async()=>{if(!strategicPlan)return;setIsExecuting(true);setExecutionStatus({stage:'initializing',message:'Creating campaign...'});try{const campaign=strategicPlanningService.generateCampaignFromPlan(strategicPlan);setExecutionStatus({stage:'campaign',message:'Campaign created successfully!'});setTimeout(()=>{navigate(\"/projects/\".concat(selectedProject===null||selectedProject===void 0?void 0:selectedProject.id,\"/campaign-execution/\").concat(campaign.id));},2000);}catch(error){console.error(\"Error executing strategic plan:\",error);setExecutionStatus({stage:'error',message:'Execution failed: '+error.message});}finally{setTimeout(()=>{setIsExecuting(false);setExecutionStatus(null);},3000);}};const addContextPill=pillId=>{const pill=contextPills.find(p=>p.id===pillId);if(pill){const contextText={'launch':'Launch our new product to market with maximum impact and strategic positioning','crisis':'Respond to crisis situation effectively while protecting reputation and stakeholder trust','thought':'Establish thought leadership in our industry through strategic content and positioning','market':'Enter new market segment strategically with proper research and positioning','reputation':'Build and enhance corporate reputation through strategic communications'};setContext(prev=>prev?\"\".concat(prev,\"\\n\\n\").concat(contextText[pillId]):contextText[pillId]);}};const loadSavedPlan=plan=>{setStrategicPlan(plan);setActiveTab('current');// Switch to Current Plan tab to show the plan inline\nsetObjective(plan.objective||'');setContext(plan.context||'');setConstraints(plan.constraints||'');setTimeline(plan.timeline||'');// Auto-expand first pillar\nif(plan.strategic_pillars&&plan.strategic_pillars.length>0){setExpandedPillars({0:true});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"strategic-planning-optimized\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"strategic-tabs\",children:tabs.map(tab=>{const Icon=tab.icon;return/*#__PURE__*/_jsxs(\"button\",{className:\"tab-button \".concat(activeTab===tab.id?'active':''),onClick:()=>setActiveTab(tab.id),children:[/*#__PURE__*/_jsx(Icon,{className:\"tab-icon\"}),tab.label]},tab.id);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"strategic-content\",children:[activeTab==='create'&&/*#__PURE__*/_jsxs(\"div\",{className:\"create-plan-tab\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"plan-type-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Planning Type\"}),/*#__PURE__*/_jsx(\"div\",{className:\"plan-types-compact\",children:planningTypes.map(type=>{const Icon=type.icon;return/*#__PURE__*/_jsxs(\"div\",{className:\"plan-type-compact \".concat(selectedPlanType===type.id?'selected':''),onClick:()=>setSelectedPlanType(type.id),children:[/*#__PURE__*/_jsx(Icon,{className:\"plan-type-icon-small\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"plan-type-label\",children:type.label}),/*#__PURE__*/_jsx(\"div\",{className:\"plan-type-desc\",children:type.desc})]})]},type.id);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group-compact\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(Target,{className:\"form-icon-small\"}),\"Objective\"]}),/*#__PURE__*/_jsx(\"textarea\",{value:objective,onChange:e=>setObjective(e.target.value),placeholder:\"What do you want to achieve?\",rows:\"2\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"context-pills-compact\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Quick Context:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"pills-row\",children:contextPills.map(pill=>{const Icon=pill.icon;return/*#__PURE__*/_jsxs(\"button\",{className:\"context-pill-small\",onClick:()=>addContextPill(pill.id),style:{borderColor:pill.color},children:[/*#__PURE__*/_jsx(Icon,{className:\"pill-icon-small\",style:{color:pill.color}}),pill.label]},pill.id);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row-compact\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group-half\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(Info,{className:\"form-icon-small\"}),\"Context\"]}),/*#__PURE__*/_jsx(\"textarea\",{value:context,onChange:e=>setContext(e.target.value),placeholder:\"Background, situation...\",rows:\"2\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group-half\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"form-icon-small\"}),\"Constraints\"]}),/*#__PURE__*/_jsx(\"textarea\",{value:constraints,onChange:e=>setConstraints(e.target.value),placeholder:\"Budget, timeline limits...\",rows:\"2\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group-compact\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(Clock,{className:\"form-icon-small\"}),\"Timeline\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:timeline,onChange:e=>setTimeline(e.target.value),placeholder:\"e.g., 3 months, Q1 2025\"})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-message-compact\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"error-icon-small\"}),error]}),/*#__PURE__*/_jsx(\"button\",{className:\"generate-btn-compact\",onClick:generateStrategicPlan,disabled:isGenerating,children:isGenerating?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Loader,{className:\"loading-icon-small\"}),\"Generating...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Sparkles,{className:\"btn-icon-small\"}),\"Generate Plan\"]})})]})]}),activeTab==='current'&&/*#__PURE__*/_jsx(\"div\",{className:\"current-plan-tab\",children:strategicPlan?/*#__PURE__*/_jsxs(\"div\",{className:\"current-plan-view\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"plan-header-inline\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"plan-meta-inline\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ai-badge\",children:[/*#__PURE__*/_jsx(Brain,{size:12}),\"AI Generated Plan\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"plan-type-badge\",children:selectedPlanType})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"plan-actions-inline\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('create'),className:\"back-btn-inline\",children:[/*#__PURE__*/_jsx(ArrowRight,{size:14}),\"New Plan\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:copyPlanToClipboard,className:\"copy-btn-inline\",children:[/*#__PURE__*/_jsx(Copy,{size:14}),\"Copy\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:executeStrategicPlan,className:\"execute-btn-inline\",disabled:isExecuting,children:isExecuting?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Loader,{className:\"loading-icon-tiny\"}),\"Executing...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Play,{size:14}),\"Execute\"]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"plan-content-inline\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"plan-objective\",children:strategicPlan.objective}),/*#__PURE__*/_jsxs(\"div\",{className:\"plan-section-inline\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[/*#__PURE__*/_jsx(Target,{size:16}),\"Executive Summary\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"executive-summary-inline\",children:strategicPlan.executive_summary})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"plan-section-inline\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[/*#__PURE__*/_jsx(Lightbulb,{size:16}),\"Strategic Pillars (\",((_strategicPlan$strate2=strategicPlan.strategic_pillars)===null||_strategicPlan$strate2===void 0?void 0:_strategicPlan$strate2.length)||0,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"pillars-inline\",children:(_strategicPlan$strate3=strategicPlan.strategic_pillars)===null||_strategicPlan$strate3===void 0?void 0:_strategicPlan$strate3.map((pillar,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"pillar-inline\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"pillar-header-inline-toggle\",onClick:()=>togglePillar(index),children:[/*#__PURE__*/_jsx(\"h5\",{children:pillar.title}),expandedPillars[index]?/*#__PURE__*/_jsx(ChevronDown,{size:16}):/*#__PURE__*/_jsx(ChevronRight,{size:16})]}),expandedPillars[index]&&/*#__PURE__*/_jsxs(\"div\",{className:\"pillar-details-inline\",children:[/*#__PURE__*/_jsx(\"p\",{children:pillar.description}),pillar.actions&&/*#__PURE__*/_jsxs(\"div\",{className:\"pillar-actions-inline\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Actions:\"}),/*#__PURE__*/_jsx(\"ul\",{children:pillar.actions.map((action,actionIndex)=>/*#__PURE__*/_jsx(\"li\",{children:action},actionIndex))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pillar-meta-inline\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(Clock,{size:14}),pillar.timeline||'TBD']}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(Zap,{size:14}),pillar.mcp||'Content Generator']})]})]})]},index))})]}),strategicPlan.success_metrics&&/*#__PURE__*/_jsxs(\"div\",{className:\"plan-section-inline\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[/*#__PURE__*/_jsx(BarChart3,{size:16}),\"Success Metrics\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"metrics-inline\",children:strategicPlan.success_metrics.map((metric,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"metric-inline\",children:[/*#__PURE__*/_jsx(CheckCircle,{size:14}),/*#__PURE__*/_jsx(\"span\",{children:metric})]},index))})]})]}),executionStatus&&/*#__PURE__*/_jsx(\"div\",{className:\"execution-status-inline\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"status-content-inline\",children:[executionStatus.stage==='error'?/*#__PURE__*/_jsx(AlertCircle,{className:\"status-icon-inline error\"}):/*#__PURE__*/_jsx(Loader,{className:\"status-icon-inline loading\"}),/*#__PURE__*/_jsx(\"span\",{children:executionStatus.message})]})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"no-plan-state\",children:[/*#__PURE__*/_jsx(FileText,{className:\"no-plan-icon\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No Strategic Plan Generated\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Generate a strategic plan from the Create Plan tab to view it here.\"}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:'0.75rem',color:'rgba(255, 255, 255, 0.4)',marginBottom:'1.5rem'},children:[\"Debug: strategicPlan = \",strategicPlan?'EXISTS':'NULL']}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('create'),className:\"create-plan-btn\",children:[/*#__PURE__*/_jsx(Brain,{size:16}),\"Create Plan\"]})]})}),activeTab==='saved'&&/*#__PURE__*/_jsxs(\"div\",{className:\"saved-plans-tab\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Saved Strategic Plans (\",savedPlans.length,\")\"]}),savedPlans.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state-compact\",children:[/*#__PURE__*/_jsx(FileText,{className:\"empty-icon-small\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No saved plans yet\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'0.75rem',color:'rgba(255, 255, 255, 0.5)'},children:\"Generate a plan from the Create Plan tab to see it here.\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"plans-grid\",children:savedPlans.map(plan=>{var _plan$objective;return/*#__PURE__*/_jsxs(\"div\",{className:\"plan-card\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[(_plan$objective=plan.objective)===null||_plan$objective===void 0?void 0:_plan$objective.substring(0,50),\"...\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"plan-meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"plan-date\",children:new Date(plan.created_at).toLocaleDateString()}),/*#__PURE__*/_jsx(\"span\",{className:\"plan-type\",children:\"Strategic Plan\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{console.log('Loading saved plan:',plan);loadSavedPlan(plan);},className:\"load-btn-compact\",children:[/*#__PURE__*/_jsx(Eye,{className:\"btn-icon-tiny\"}),\"View Plan\"]})]},plan.id);})})]}),activeTab==='history'&&/*#__PURE__*/_jsxs(\"div\",{className:\"analytics-tab\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Plan Analytics\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"analytics-placeholder\",children:[/*#__PURE__*/_jsx(BarChart3,{className:\"analytics-icon\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Analytics and performance tracking coming soon\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"analytics-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"Total Plans\"}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-value\",children:savedPlans.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"This Month\"}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-value\",children:savedPlans.filter(plan=>new Date(plan.created_at).getMonth()===new Date().getMonth()).length})]})]})]})]})]})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}