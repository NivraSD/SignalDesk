{"ast":null,"code":"import _objectSpread from\"/Users/jonathanliebowitz/Desktop/SignalDesk/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Brain,Users,Activity,BarChart3,Target,Network,Bot,Settings,CheckCircle,AlertCircle,TrendingUp,Plus,X,Zap,Sparkles,Megaphone,Shield,Lightbulb,Building2}from'lucide-react';import EnhancedAIStrategyAdvisor from'./EnhancedAIStrategyAdvisor';import PRStrategyAdvisor from'./PRStrategyAdvisor';import PRMonitoringDashboard from'./PRMonitoringDashboard';import OpportunityDiscoveryDashboard from'../OpportunityDiscovery/OpportunityDiscoveryDashboard';import AgenticMonitoring from'./AgenticMonitoring';import StakeholderAIAdvisor from'./StakeholderAIAdvisor';import IntelligenceConfiguration from'../Intelligence/IntelligenceConfiguration';import IntelligenceSummaryDashboard from'../Intelligence/IntelligenceSummaryDashboard';import OpportunityDetection from'../Intelligence/OpportunityDetection';import apiService from'../../services/apiService';import{useIntelligence}from'../../context/IntelligenceContext';// Using new backend-integrated Intelligence Dashboard\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const StakeholderIntelligenceHub=()=>{var _stakeholderStrategy$,_stakeholderStrategy$2,_stakeholderStrategy$3,_stakeholderStrategy$4;console.log('ðŸš¨ðŸš¨ðŸš¨ STAKEHOLDER HUB LOADED - VERSION 2.0 ðŸš¨ðŸš¨ðŸš¨');// Get context\nconst{organizationData,updateOrganizationData}=useIntelligence();const[activeTab,setActiveTab]=useState('monitoring');// Start with configuration\nconst[isPRMode,setIsPRMode]=useState(true);// Default to PR mode\nconst[stakeholderStrategy,setStakeholderStrategy]=useState(organizationData.strategy);const[intelligenceFindings,setIntelligenceFindings]=useState([]);const[customSources,setCustomSources]=useState([]);const[priorityStakeholders,setPriorityStakeholders]=useState([]);const[showAddStakeholder,setShowAddStakeholder]=useState(false);const[newStakeholderName,setNewStakeholderName]=useState('');const[newStakeholderDescription,setNewStakeholderDescription]=useState('');const[isRunningAnalysis,setIsRunningAnalysis]=useState(false);const[organizationId,setOrganizationId]=useState(organizationData.id||'demo-org-id');// Use context or default\n// Debug stakeholder strategy changes\nuseEffect(()=>{console.log('StakeholderStrategy changed:',stakeholderStrategy);if(stakeholderStrategy&&stakeholderStrategy.stakeholderGroups){console.log('Stakeholder groups:',stakeholderStrategy.stakeholderGroups);}},[stakeholderStrategy]);const handleStrategyComplete=async data=>{var _data$stakeholderGrou;console.log('Strategy completed:',data);console.log('Stakeholder groups received:',data.stakeholderGroups);console.log('Number of stakeholder groups:',(_data$stakeholderGrou=data.stakeholderGroups)===null||_data$stakeholderGrou===void 0?void 0:_data$stakeholderGrou.length);// Set organization ID immediately so dashboard can use it\nconst orgId=data.organizationId||\"org-\".concat(Date.now());setOrganizationId(orgId);console.log('Organization ID set to:',orgId);// Update context with organization data\nupdateOrganizationData({id:orgId,name:data.company,targets:data.stakeholders||[],strategy:data});// Create targets in backend for the stakeholders\nif(data.stakeholders&&data.stakeholders.length>0&&orgId){try{const targetPromises=data.stakeholders.map(stakeholder=>{const targetData={organization_id:orgId,name:stakeholder.name,type:stakeholder.type==='competitor'?'competitor':'topic',priority:stakeholder.priority||'medium',keywords:stakeholder.keywords||[],topics:stakeholder.topics||stakeholder.monitoringTopics||[],sources:Array.isArray(stakeholder.sources)?stakeholder.sources:[],description:stakeholder.reason||\"Monitor \".concat(stakeholder.name),active:true};return apiService.createTarget(targetData);});const createdTargets=await Promise.all(targetPromises);console.log('Created targets in backend:',createdTargets);// Create individual stakeholder groups for each competitor and topic\nconst stakeholderGroups=[];// Process each stakeholder - they already come as individual items\nconsole.log('ðŸ” Processing stakeholders:',data.stakeholders);data.stakeholders.forEach((stakeholder,idx)=>{console.log('ðŸ” Stakeholder:',stakeholder);// Each stakeholder already represents a single competitor or topic\nstakeholderGroups.push({id:stakeholder.id||\"\".concat(stakeholder.type,\"-\").concat(idx),name:stakeholder.name,type:stakeholder.type,influence:stakeholder.influence||(stakeholder.priority==='high'?9:stakeholder.priority==='medium'?7:5),interest:stakeholder.priority==='high'?9:stakeholder.priority==='medium'?7:5,keywords:stakeholder.keywords||[stakeholder.name.toLowerCase()],topics:stakeholder.topics||stakeholder.monitoringTopics||[],preIndexed:stakeholder.preIndexed||false,sourceCount:stakeholder.sourceCount||0});});// Set stakeholder strategy for source configuration\nconst monitoringStrategy={organizationId:orgId,company:data.company,stakeholderGroups:stakeholderGroups,stakeholders:data.stakeholders};setStakeholderStrategy(monitoringStrategy);console.log('ðŸŽ¯ Set stakeholder strategy with',stakeholderGroups.length,'individual items');console.log('ðŸŽ¯ Individual targets created:');stakeholderGroups.forEach(g=>console.log(\"  - \".concat(g.type,\": \").concat(g.name)));console.log('ðŸŽ¯ Full strategy:',monitoringStrategy);// Navigate to monitoring tab after setting strategy\nsetTimeout(()=>{setActiveTab('monitoring');console.log('ðŸŽ¯ Navigated to monitoring tab');},100);}catch(error){console.error('Error creating targets:',error);}}// Check if this is from PR Strategy Advisor\nif(data.prFocus){var _monitoringStrategy$s;// Handle PR-specific strategy\n// orgId already set above\nconst monitoringStrategy=_objectSpread(_objectSpread({},data),{},{organizationId:orgId,profile:{company:data.company,industry:data.industry||'PR/Communications',businessModel:data.userType==='brand'?'Brand':'Agency',keyCompetitors:data.competitors||[],keyRisks:[],opportunities:[],overview:data.objectives||''},stakeholderGroups:data.stakeholderGroups,// Use the properly formatted stakeholder groups\nstakeholders:data.stakeholders,// Keep raw stakeholders too\nindustry:data.industry||'PR/Communications',companyProfile:data.companyProfile,goals:data.goals,sources:data.sources||[]});console.log('Setting stakeholder strategy with',(_monitoringStrategy$s=monitoringStrategy.stakeholderGroups)===null||_monitoringStrategy$s===void 0?void 0:_monitoringStrategy$s.length,'groups');setStakeholderStrategy(monitoringStrategy);// Set priority stakeholders for tracking - include ALL stakeholders\nif(data.stakeholderGroups&&data.stakeholderGroups.length>0){const allStakeholders=data.stakeholderGroups.map(s=>String(s.id||s.name));console.log('Setting priority stakeholders:',allStakeholders);setPriorityStakeholders(allStakeholders);}setActiveTab('monitoring');// Go to source configuration\nreturn;}// Original handling for general strategy\nconst stakeholderGroups=data.stakeholders.map((stakeholder,idx)=>({id:stakeholder.id||\"stakeholder-\".concat(idx),name:stakeholder.name,type:stakeholder.type,influence:stakeholder.influence||(stakeholder.priority==='high'?9:stakeholder.priority==='medium'?7:5),interest:stakeholder.priority==='high'?9:stakeholder.priority==='medium'?7:5,sentiment:'neutral',currentSentiment:5,targetSentiment:8,engagementLevel:6,trend:'stable',concerns:[stakeholder.reason],influencers:[],keywords:stakeholder.keywords||[],topics:stakeholder.topics||stakeholder.monitoringTopics||[],goals:stakeholder.goals||'',fears:stakeholder.fears||'',preIndexed:stakeholder.preIndexed||false,sourceCount:stakeholder.sourceCount||0}));// Extract all keywords from stakeholders\nconst allKeywords=data.stakeholders.reduce((keywords,stakeholder)=>{return[...keywords,...(stakeholder.keywords||[])];},[data.company]);// Remove duplicates\nconst uniqueKeywords=[...new Set(allKeywords)];console.log('Extracted keywords:',uniqueKeywords);// Organization ID already set above\n// Transform into monitoring strategy\nconst monitoringStrategy={organizationId:orgId,profile:{company:data.company,industry:data.industry,businessModel:'B2B/B2C',keyCompetitors:[],keyRisks:[],opportunities:[],overview:data.overview},strategy:{keywords:uniqueKeywords,sources:{rss:['https://techcrunch.com/feed/','https://www.theverge.com/rss/index.xml','https://feeds.feedburner.com/venturebeat/SZYF','https://www.prnewswire.com/rss/news-releases-list.rss'],categories:['business','technology','press-releases']},alertThresholds:{sentiment:'negative',volume:10,urgency:'high'},reviewFrequency:'Daily'},stakeholderGroups:stakeholderGroups,aiStrategy:null,timeframe:'6 months',resources:'moderate',enhancedFeatures:data.enhancedFeatures||{preIndexedCount:stakeholderGroups.filter(s=>s.preIndexed).length,totalSources:stakeholderGroups.reduce((acc,s)=>acc+s.sourceCount,0),researchAgentsEnabled:true}};console.log('Created monitoring strategy:',monitoringStrategy);console.log('Stakeholder groups in strategy:',monitoringStrategy.stakeholderGroups);setStakeholderStrategy(monitoringStrategy);// Initialize with all selected stakeholders - ensure they are strings\nconst allStakeholders=stakeholderGroups.map(s=>{const id=String(s.id||s.name);console.log(\"Stakeholder \".concat(s.name,\" will have ID: \").concat(id));return id;});console.log('Setting all selected stakeholders:',allStakeholders);setPriorityStakeholders(allStakeholders);// Tab navigation happens after strategy is set\n};const tabs=[{id:'monitoring',name:'Intelligence Configuration',icon:Settings},{id:'dashboard',name:'Intelligence Summary',icon:BarChart3},{id:'detection',name:'Opportunity Detection',icon:Zap}];return/*#__PURE__*/_jsxs(\"div\",{style:{height:'100vh',display:'flex',flexDirection:'column',background:'#f9fafb',fontFamily:'-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',borderBottom:'1px solid #e5e7eb',padding:'0 1.5rem',boxShadow:'0 1px 3px rgba(0,0,0,0.05)'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between',height:'5rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'1rem'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'48px',height:'48px',background:'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',borderRadius:'0.75rem',display:'flex',alignItems:'center',justifyContent:'center',boxShadow:'0 4px 6px rgba(102, 126, 234, 0.3)'},children:/*#__PURE__*/_jsx(Zap,{size:28,style:{color:'white'}})}),/*#__PURE__*/_jsx(\"h1\",{style:{margin:0,fontSize:'2rem',fontWeight:'800',color:'#111827',letterSpacing:'-0.025em'},children:\"Opportunity Engine\"})]}),stakeholderStrategy&&stakeholderStrategy.stakeholderGroups&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'1rem',padding:'0.5rem 1rem',background:'#f9fafb',borderRadius:'0.5rem',border:'1px solid #e5e7eb'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'0.75rem',color:'#6b7280'},children:\"Strategic Health\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:'40px',height:'40px',borderRadius:'50%',background:\"conic-gradient(#6366f1 0deg, #6366f1 \".concat((stakeholderStrategy.stakeholderGroups?Math.round(stakeholderStrategy.stakeholderGroups.reduce((acc,s)=>acc+s.currentSentiment/s.targetSentiment*100,0)/stakeholderStrategy.stakeholderGroups.length):0)*3.6,\"deg, #e5e7eb \").concat((stakeholderStrategy.stakeholderGroups?Math.round(stakeholderStrategy.stakeholderGroups.reduce((acc,s)=>acc+s.currentSentiment/s.targetSentiment*100,0)/stakeholderStrategy.stakeholderGroups.length):0)*3.6,\"deg)\"),display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsxs(\"div\",{style:{width:'32px',height:'32px',borderRadius:'50%',background:'white',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'0.75rem',fontWeight:'bold',color:'#111827'},children:[stakeholderStrategy.stakeholderGroups?Math.round(stakeholderStrategy.stakeholderGroups.reduce((acc,s)=>acc+s.currentSentiment/s.targetSentiment*100,0)/stakeholderStrategy.stakeholderGroups.length):0,\"%\"]})}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'0.625rem',color:'#6b7280'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[((_stakeholderStrategy$=stakeholderStrategy.stakeholderGroups)===null||_stakeholderStrategy$===void 0?void 0:_stakeholderStrategy$.filter(s=>s.currentSentiment>=7).length)||0,\" positive\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[((_stakeholderStrategy$2=stakeholderStrategy.stakeholderGroups)===null||_stakeholderStrategy$2===void 0?void 0:_stakeholderStrategy$2.filter(s=>s.currentSentiment<5).length)||0,\" need work\"]})]})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',gap:'0.5rem',height:'3rem',alignItems:'stretch'},children:tabs.map(tab=>{const Icon=tab.icon;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab(tab.id),style:{display:'flex',alignItems:'center',gap:'0.5rem',padding:'0 1rem',border:'none',borderBottom:activeTab===tab.id?'2px solid #6366f1':'2px solid transparent',background:'transparent',color:activeTab===tab.id?'#6366f1':'#6b7280',fontWeight:activeTab===tab.id?'600':'400',fontSize:'0.875rem',cursor:'pointer',transition:'all 0.15s ease',whiteSpace:'nowrap'},onMouseEnter:e=>{if(activeTab!==tab.id){e.currentTarget.style.color='#4b5563';e.currentTarget.style.borderBottomColor='#e5e7eb';}},onMouseLeave:e=>{if(activeTab!==tab.id){e.currentTarget.style.color='#6b7280';e.currentTarget.style.borderBottomColor='transparent';}},children:[/*#__PURE__*/_jsx(Icon,{size:16}),tab.name]},tab.id);})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1,overflow:'auto',height:'100%'},children:[activeTab==='discovery'&&/*#__PURE__*/_jsx(OpportunityDiscoveryDashboard,{client:(stakeholderStrategy===null||stakeholderStrategy===void 0?void 0:stakeholderStrategy.companyProfile)||(stakeholderStrategy===null||stakeholderStrategy===void 0?void 0:stakeholderStrategy.profile)||{company:(stakeholderStrategy===null||stakeholderStrategy===void 0?void 0:stakeholderStrategy.company)||'Your Company',industry:(stakeholderStrategy===null||stakeholderStrategy===void 0?void 0:stakeholderStrategy.industry)||'technology',expertiseAreas:(stakeholderStrategy===null||stakeholderStrategy===void 0?void 0:(_stakeholderStrategy$3=stakeholderStrategy.companyProfile)===null||_stakeholderStrategy$3===void 0?void 0:_stakeholderStrategy$3.expertiseAreas)||{'AI':0.8,'cloud':0.7,'security':0.6},competitors:(stakeholderStrategy===null||stakeholderStrategy===void 0?void 0:(_stakeholderStrategy$4=stakeholderStrategy.companyProfile)===null||_stakeholderStrategy$4===void 0?void 0:_stakeholderStrategy$4.competitors)||['Microsoft','Google','Amazon'],userType:stakeholderStrategy===null||stakeholderStrategy===void 0?void 0:stakeholderStrategy.userType,objectives:stakeholderStrategy===null||stakeholderStrategy===void 0?void 0:stakeholderStrategy.objectives,goals:stakeholderStrategy===null||stakeholderStrategy===void 0?void 0:stakeholderStrategy.goals},onOpportunitySelect:opportunity=>{console.log('Opportunity selected:',opportunity);// Could transition to PR strategy or content creation\nsetActiveTab('pr-strategy');}}),activeTab==='pr-strategy'&&/*#__PURE__*/_jsx(PRStrategyAdvisor,{onStrategyComplete:handleStrategyComplete}),activeTab==='pr-monitoring'&&/*#__PURE__*/_jsx(PRMonitoringDashboard,{strategy:stakeholderStrategy}),activeTab==='dashboard'&&organizationId&&/*#__PURE__*/_jsx(IntelligenceSummaryDashboard,{organizationId:organizationId,organizationName:organizationData.name||(stakeholderStrategy===null||stakeholderStrategy===void 0?void 0:stakeholderStrategy.company)||\"Your Organization\"},organizationId),activeTab==='dashboard'&&!organizationId&&/*#__PURE__*/_jsx(\"div\",{style:{padding:'2rem',textAlign:'center',color:'#6b7280'},children:/*#__PURE__*/_jsx(\"p\",{children:\"Please complete the Intelligence Targets setup first to configure monitoring.\"})}),activeTab==='detection'&&organizationId&&/*#__PURE__*/_jsx(OpportunityDetection,{organizationId:organizationId,organizationName:organizationData.name||(stakeholderStrategy===null||stakeholderStrategy===void 0?void 0:stakeholderStrategy.company)||\"Your Organization\"},organizationId),activeTab==='detection'&&!organizationId&&/*#__PURE__*/_jsx(\"div\",{style:{padding:'2rem',textAlign:'center',color:'#6b7280'},children:/*#__PURE__*/_jsx(\"p\",{children:\"Please complete the Intelligence Targets setup first to access Opportunity Detection.\"})}),activeTab==='monitoring'&&/*#__PURE__*/_jsx(IntelligenceConfiguration,{stakeholderStrategy:stakeholderStrategy,onSourcesUpdate:sources=>setCustomSources(sources),organizationId:organizationId,onSetupComplete:handleStrategyComplete})]})]});};export default StakeholderIntelligenceHub;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}