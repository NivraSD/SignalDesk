<!DOCTYPE html>
<html>
<head>
  <title>Opportunity Engine Test</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #1a1a1a; color: white; }
    .opp { background: #2a2a2a; padding: 15px; margin: 10px 0; border-radius: 8px; }
    .urgent { border-left: 4px solid #ff4444; }
    .high { border-left: 4px solid #ff8844; }
    .medium { border-left: 4px solid #ffaa44; }
    button { background: #4a9eff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>üéØ Opportunity Engine - Live Test</h1>
  <button onclick="fetchOpportunities()">Fetch Opportunities</button>
  <div id="status"></div>
  <div id="opportunities"></div>

  <script>
    const SUPABASE_URL = 'https://zskaxjtyuaqazydouifp.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inpza2F4anR5dWFxYXp5ZG91aWZwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NTEyOTYzNywiZXhwIjoyMDcwNzA1NjM3fQ.WO35k7riuKT2QXj_YvbtRwzLwi3Pev30-X9Yziej2pM';

    async function fetchOpportunities() {
      const status = document.getElementById('status');
      const oppDiv = document.getElementById('opportunities');
      
      status.innerHTML = '‚è≥ Fetching opportunities...';
      
      try {
        // Fetch directly from Supabase
        const response = await fetch(`${SUPABASE_URL}/rest/v1/opportunities?select=*&order=created_at.desc&limit=10`, {
          headers: {
            'apikey': SUPABASE_KEY,
            'Authorization': `Bearer ${SUPABASE_KEY}`
          }
        });
        
        const opportunities = await response.json();
        
        status.innerHTML = `‚úÖ Found ${opportunities.length} opportunities`;
        
        oppDiv.innerHTML = opportunities.map(opp => `
          <div class="opp ${opp.urgency}">
            <h3>${opp.title}</h3>
            <p>${opp.description}</p>
            <div style="display: flex; gap: 20px; margin-top: 10px;">
              <span>üéØ Score: ${opp.score}</span>
              <span>‚ö° Urgency: ${opp.urgency}</span>
              <span>üè∑Ô∏è Category: ${opp.category || 'N/A'}</span>
              <span>‚è∞ Window: ${opp.time_window}</span>
            </div>
            <div style="margin-top: 10px; font-size: 12px; color: #888;">
              Created: ${new Date(opp.created_at).toLocaleString()}
            </div>
          </div>
        `).join('');
        
      } catch (error) {
        status.innerHTML = `‚ùå Error: ${error.message}`;
        console.error(error);
      }
    }

    // Auto-fetch on load
    fetchOpportunities();
  </script>
</body>
</html>
