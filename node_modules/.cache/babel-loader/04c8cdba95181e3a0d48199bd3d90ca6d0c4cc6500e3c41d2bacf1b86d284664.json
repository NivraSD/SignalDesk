{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./PRDashboard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PRDashboard=_ref=>{var _dashboard$now,_dashboard$now$urgent;let{organization}=_ref;const[activeTab,setActiveTab]=useState('now');const[dashboard,setDashboard]=useState(null);const[loading,setLoading]=useState(true);const[selectedItem,setSelectedItem]=useState(null);useEffect(()=>{if(organization){fetchPRIntelligence();}},[organization]);const fetchPRIntelligence=async()=>{setLoading(true);try{// Use existing intelligence gathering for now (Firecrawl out of credits)\n// Fall back to v3 gathering which uses RSS feeds\nconst gatherResponse=await fetch('https://zskaxjtyuaqazydouifp.supabase.co/functions/v1/intelligence-gathering-v3',{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inpza2F4anR5dWFxYXp5ZG91aWZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU3Nzk5MjgsImV4cCI6MjA1MTM1NTkyOH0.MJgH4j8wXJhZgfvMOpViiCyxT-BlLCIIqVMJsE_lXG0'},body:JSON.stringify({entities:{competitors:(organization===null||organization===void 0?void 0:organization.competitors)||['Walmart','Amazon','Costco']},organization})});if(gatherResponse.ok){var _gatherData$entity_ac,_gatherData$entity_ac2,_gatherData$topic_tre;const gatherData=await gatherResponse.json();// Transform v3 data to PR intelligence format\nconst intelligence={competitor_moves:((_gatherData$entity_ac=gatherData.entity_actions)===null||_gatherData$entity_ac===void 0?void 0:(_gatherData$entity_ac2=_gatherData$entity_ac.all)===null||_gatherData$entity_ac2===void 0?void 0:_gatherData$entity_ac2.filter(a=>a.type==='competitor'||a.relevance>0.7))||[],trending_narratives:((_gatherData$topic_tre=gatherData.topic_trends)===null||_gatherData$topic_tre===void 0?void 0:_gatherData$topic_tre.all)||[],media_opportunities:[],journalist_activity:[],crisis_signals:[]};// Then synthesize into PR dashboard\nconst synthesisResponse=await fetch('https://zskaxjtyuaqazydouifp.supabase.co/functions/v1/pr-synthesis',{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inpza2F4anR5dWFxYXp5ZG91aWZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU3Nzk5MjgsImV4cCI6MjA1MTM1NTkyOH0.MJgH4j8wXJhZgfvMOpViiCyxT-BlLCIIqVMJsE_lXG0'},body:JSON.stringify({organization,intelligence})});if(synthesisResponse.ok){const result=await synthesisResponse.json();setDashboard(result.dashboard);}}}catch(error){console.error('Error fetching PR intelligence:',error);}finally{setLoading(false);}};const renderNowTab=()=>{if(!(dashboard!==null&&dashboard!==void 0&&dashboard.now))return/*#__PURE__*/_jsx(\"div\",{children:\"No urgent items\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"now-tab\",children:[dashboard.now.urgent_actions.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"section urgent-actions\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDEA8 Urgent Actions Required\"}),dashboard.now.urgent_actions.map((action,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"urgent-action-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"action-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"action-type\",children:action.type}),/*#__PURE__*/_jsx(\"span\",{className:\"deadline\",children:action.deadline})]}),/*#__PURE__*/_jsx(\"div\",{className:\"action-title\",children:action.their_move}),/*#__PURE__*/_jsx(\"div\",{className:\"our-angle\",children:action.our_angle}),/*#__PURE__*/_jsx(\"button\",{className:\"action-btn\",onClick:()=>setSelectedItem(action),children:\"Take Action \\u2192\"})]},idx))]}),dashboard.now.active_conversations.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"section active-conversations\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCAC Active Media Conversations\"}),/*#__PURE__*/_jsx(\"div\",{className:\"conversation-list\",children:dashboard.now.active_conversations.map((conv,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"topic\",children:conv.topic}),/*#__PURE__*/_jsx(\"span\",{className:\"momentum \".concat(conv.momentum.toLowerCase()),children:conv.momentum}),/*#__PURE__*/_jsx(\"span\",{className:\"action\",children:conv.action})]},idx))})]}),dashboard.now.monitoring.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"section monitoring\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDC41\\uFE0F Monitoring\"}),dashboard.now.monitoring.map((item,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"monitor-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"monitor-type\",children:item.type}),/*#__PURE__*/_jsx(\"span\",{className:\"monitor-issue\",children:item.issue})]},idx))]})]});};const renderOpportunitiesTab=()=>{if(!(dashboard!==null&&dashboard!==void 0&&dashboard.opportunities))return/*#__PURE__*/_jsx(\"div\",{children:\"No opportunities\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"opportunities-tab\",children:[dashboard.opportunities.media_pitches.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"section media-pitches\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCF0 Media Pitch Opportunities\"}),dashboard.opportunities.media_pitches.map((pitch,idx)=>{var _pitch$talking_points;return/*#__PURE__*/_jsxs(\"div\",{className:\"pitch-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"pitch-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"journalist\",children:pitch.journalist}),/*#__PURE__*/_jsx(\"span\",{className:\"publication\",children:pitch.publication})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"recent-coverage\",children:[\"Recently wrote: \",pitch.recent_coverage]}),/*#__PURE__*/_jsx(\"div\",{className:\"pitch-angle\",children:pitch.pitch_angle}),/*#__PURE__*/_jsx(\"div\",{className:\"talking-points\",children:(_pitch$talking_points=pitch.talking_points)===null||_pitch$talking_points===void 0?void 0:_pitch$talking_points.map((point,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"point\",children:[\"\\u2022 \",point]},i))}),/*#__PURE__*/_jsx(\"button\",{className:\"pitch-btn\",children:\"Draft Pitch\"})]},idx);})]}),dashboard.opportunities.thought_leadership.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"section thought-leadership\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCA1 Thought Leadership\"}),dashboard.opportunities.thought_leadership.map((item,idx)=>{var _item$content_ideas;return/*#__PURE__*/_jsxs(\"div\",{className:\"thought-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"thought-topic\",children:item.topic}),/*#__PURE__*/_jsx(\"div\",{className:\"thought-angle\",children:item.angle}),/*#__PURE__*/_jsx(\"div\",{className:\"content-ideas\",children:(_item$content_ideas=item.content_ideas)===null||_item$content_ideas===void 0?void 0:_item$content_ideas.map((idea,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"idea\",children:[\"\\u2022 \",idea]},i))})]},idx);})]}),dashboard.opportunities.newsjacking.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"section newsjacking\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u26A1 Newsjacking Opportunities\"}),dashboard.opportunities.newsjacking.map((news,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"news-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"news-opportunity\",children:news.opportunity}),/*#__PURE__*/_jsx(\"div\",{className:\"news-angle\",children:news.angle}),/*#__PURE__*/_jsxs(\"div\",{className:\"news-deadline\",children:[\"Act by: \",news.deadline]})]},idx))]})]});};const renderIntelTab=()=>{if(!(dashboard!==null&&dashboard!==void 0&&dashboard.intel))return/*#__PURE__*/_jsx(\"div\",{children:\"No intelligence\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"intel-tab\",children:[dashboard.intel.competitor_activity.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"section competitor-activity\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83C\\uDFAF Competitor Activity\"}),dashboard.intel.competitor_activity.map((activity,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"competitor-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"competitor-name\",children:activity.competitor}),/*#__PURE__*/_jsx(\"div\",{className:\"competitor-action\",children:activity.activity}),/*#__PURE__*/_jsxs(\"div\",{className:\"competitor-meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"publication\",children:activity.publication}),activity.journalist&&/*#__PURE__*/_jsxs(\"span\",{className:\"journalist\",children:[\"by \",activity.journalist]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"implications\",children:activity.implications})]},idx))]}),dashboard.intel.market_dynamics.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"section market-dynamics\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCC8 Market Dynamics\"}),dashboard.intel.market_dynamics.map((dynamic,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"market-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"market-theme\",children:dynamic.theme}),/*#__PURE__*/_jsx(\"div\",{className:\"market-opportunity\",children:dynamic.opportunity}),dynamic.risk&&/*#__PURE__*/_jsxs(\"div\",{className:\"market-risk\",children:[\"Risk: \",dynamic.risk]})]},idx))]})]});};const renderExecuteTab=()=>{if(!(dashboard!==null&&dashboard!==void 0&&dashboard.execute))return/*#__PURE__*/_jsx(\"div\",{children:\"No action items\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"execute-tab\",children:[dashboard.execute.action_items.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"section action-items\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u2705 Action Items\"}),dashboard.execute.action_items.map((item,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"action-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"action-task\",children:item.task}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"priority\",children:item.priority}),/*#__PURE__*/_jsx(\"span\",{className:\"deadline\",children:item.deadline})]})]},idx))]}),dashboard.execute.media_targets.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"section media-targets\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83C\\uDFAF Media Targets\"}),dashboard.execute.media_targets.map((target,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"target-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"target-name\",children:target.name}),/*#__PURE__*/_jsx(\"div\",{className:\"target-publication\",children:target.publication}),/*#__PURE__*/_jsxs(\"div\",{className:\"target-topics\",children:[\"Topics: \",target.topics.join(', ')]}),/*#__PURE__*/_jsx(\"button\",{className:\"contact-btn\",children:\"Add to Outreach\"})]},idx))]}),dashboard.execute.talking_points.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"section talking-points\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCAC Talking Points\"}),dashboard.execute.talking_points.map((tp,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"talking-point-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"tp-topic\",children:tp.topic}),tp.points.map((point,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"tp-point\",children:[\"\\u2022 \",point]},i))]},idx))]})]});};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"pr-dashboard loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"div\",{className:\"loading-text\",children:\"Gathering PR Intelligence...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"pr-dashboard\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"PR Command Center\"}),/*#__PURE__*/_jsx(\"div\",{className:\"org-name\",children:organization===null||organization===void 0?void 0:organization.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-tabs\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"tab \".concat(activeTab==='now'?'active':''),onClick:()=>setActiveTab('now'),children:[\"NOW\",(dashboard===null||dashboard===void 0?void 0:(_dashboard$now=dashboard.now)===null||_dashboard$now===void 0?void 0:(_dashboard$now$urgent=_dashboard$now.urgent_actions)===null||_dashboard$now$urgent===void 0?void 0:_dashboard$now$urgent.length)>0&&/*#__PURE__*/_jsx(\"span\",{className:\"badge\",children:dashboard.now.urgent_actions.length})]}),/*#__PURE__*/_jsx(\"button\",{className:\"tab \".concat(activeTab==='opportunities'?'active':''),onClick:()=>setActiveTab('opportunities'),children:\"OPPORTUNITIES\"}),/*#__PURE__*/_jsx(\"button\",{className:\"tab \".concat(activeTab==='intel'?'active':''),onClick:()=>setActiveTab('intel'),children:\"INTEL\"}),/*#__PURE__*/_jsx(\"button\",{className:\"tab \".concat(activeTab==='execute'?'active':''),onClick:()=>setActiveTab('execute'),children:\"EXECUTE\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-content\",children:[activeTab==='now'&&renderNowTab(),activeTab==='opportunities'&&renderOpportunitiesTab(),activeTab==='intel'&&renderIntelTab(),activeTab==='execute'&&renderExecuteTab()]}),selectedItem&&/*#__PURE__*/_jsx(\"div\",{className:\"modal\",onClick:()=>setSelectedItem(null),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Action Details\"}),/*#__PURE__*/_jsx(\"pre\",{children:JSON.stringify(selectedItem,null,2)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedItem(null),children:\"Close\"})]})})]});};export default PRDashboard;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}