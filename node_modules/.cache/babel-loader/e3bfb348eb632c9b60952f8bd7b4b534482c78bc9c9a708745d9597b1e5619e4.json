{"ast":null,"code":"import _objectSpread from\"/Users/jonathanliebowitz/Desktop/SignalDesk/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from\"react\";import{useNavigate}from\"react-router-dom\";import{useAuth}from\"../contexts/AuthContext\";import{useProject}from\"../contexts/ProjectContext\";import*as api from\"../services/api\";import\"./ProjectList.css\";import{FolderPlus,Folder,Edit2,Trash2,ChevronDown,ChevronRight,Calendar,Tag,CheckSquare,Square,Plus,X}from\"lucide-react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProjectList=()=>{const navigate=useNavigate();const{user}=useAuth();const{projects,selectProject,fetchProjects}=useProject();const[expandedProjects,setExpandedProjects]=useState({});const[showCreateForm,setShowCreateForm]=useState(false);const[editingProject,setEditingProject]=useState(null);const[loading,setLoading]=useState(true);const[todos,setTodos]=useState([]);const[selectedProjectId,setSelectedProjectId]=useState(\"\");const[showTodoModal,setShowTodoModal]=useState(false);const[todoFormData,setTodoFormData]=useState({title:\"\",description:\"\",priority:\"medium\"});const[formData,setFormData]=useState({name:\"\",campaign:\"\",industry:\"\",description:\"\"});useEffect(()=>{loadData();},[]);const loadData=async()=>{try{setLoading(true);await fetchProjects();await fetchTodos();}catch(error){console.error(\"Error loading data:\",error);}finally{setLoading(false);}};const fetchTodos=async()=>{try{const response=await api.getTodos();if(response.success){setTodos(response.todos);}}catch(error){console.error(\"Error fetching todos:\",error);}};const handleProjectClick=project=>{selectProject(project);navigate(\"/projects/\".concat(project.id));};const toggleProjectExpand=(projectId,e)=>{e.stopPropagation();setExpandedProjects(prev=>_objectSpread(_objectSpread({},prev),{},{[projectId]:!prev[projectId]}));};const handleCreateProject=async e=>{e.preventDefault();try{const response=await api.createProject(formData);if(response.success){await fetchProjects();setShowCreateForm(false);setFormData({name:\"\",campaign:\"\",industry:\"\",description:\"\"});handleProjectClick(response.project);}}catch(error){console.error(\"Error creating project:\",error);alert(\"Failed to create project: \".concat(error.message));}};const handleUpdateProject=async e=>{e.preventDefault();try{const response=await api.updateProject(editingProject.id,formData);if(response.success){await fetchProjects();setEditingProject(null);setFormData({name:\"\",campaign:\"\",industry:\"\",description:\"\"});}}catch(error){console.error(\"Error updating project:\",error);alert(\"Failed to update project: \".concat(error.message));}};const handleDeleteProject=async(projectId,e)=>{e.stopPropagation();if(window.confirm(\"Are you sure you want to delete this project?\")){try{await api.deleteProject(projectId);await fetchProjects();}catch(error){console.error(\"Error deleting project:\",error);alert(\"Failed to delete project: \".concat(error.message));}}};// Open todo modal\nconst openTodoModal=()=>{setShowTodoModal(true);setTodoFormData({title:\"\",description:\"\",priority:\"medium\"});};// Handle todo form submission\nconst handleCreateTodo=async e=>{e.preventDefault();if(!todoFormData.title.trim()){alert(\"Please enter a todo title\");return;}try{const todoData={title:todoFormData.title.trim(),description:todoFormData.description.trim(),project_id:selectedProjectId||null,priority:todoFormData.priority,status:\"pending\"};const response=await api.createTodo(todoData);if(response.success){await fetchTodos();setShowTodoModal(false);setTodoFormData({title:\"\",description:\"\",priority:\"medium\"});}else{throw new Error(response.message||\"Failed to create todo\");}}catch(error){console.error(\"Error creating todo:\",error);alert(\"Failed to create todo: \".concat(error.message));}};const handleToggleTodo=async(todoId,currentStatus)=>{try{const newStatus=currentStatus===\"completed\"?\"pending\":\"completed\";const response=await api.updateTodo(todoId,{status:newStatus});if(response.success){await fetchTodos();}}catch(error){console.error(\"Error updating todo:\",error);}};const handleDeleteTodo=async todoId=>{try{const response=await api.deleteTodo(todoId);if(response.success){await fetchTodos();}}catch(error){console.error(\"Error deleting todo:\",error);}};const startEdit=(project,e)=>{e.stopPropagation();setEditingProject(project);setFormData({name:project.name,campaign:project.campaign_name||\"\",industry:project.industry||\"\",description:project.description||\"\"});};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading projects...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"projects-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"projects-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"projects-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"projects-header\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"projects-title\",children:\"My Projects\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowCreateForm(true),className:\"create-project-btn\",children:[/*#__PURE__*/_jsx(FolderPlus,{size:16}),/*#__PURE__*/_jsx(\"span\",{children:\"New Project\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"projects-list\",children:projects.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(FolderPlus,{size:48}),/*#__PURE__*/_jsx(\"p\",{children:\"No projects yet. Create your first project!\"})]}):projects.map(project=>/*#__PURE__*/_jsxs(\"div\",{className:\"project-card\",onClick:()=>handleProjectClick(project),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"project-card-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"project-info\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>toggleProjectExpand(project.id,e),className:\"icon-button\",children:expandedProjects[project.id]?/*#__PURE__*/_jsx(ChevronDown,{size:16}):/*#__PURE__*/_jsx(ChevronRight,{size:16})}),/*#__PURE__*/_jsx(Folder,{size:18,color:\"#8b5cf6\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"project-name\",children:project.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"project-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>startEdit(project,e),className:\"icon-button\",children:/*#__PURE__*/_jsx(Edit2,{size:16})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>handleDeleteProject(project.id,e),className:\"icon-button\",children:/*#__PURE__*/_jsx(Trash2,{size:16})})]})]}),expandedProjects[project.id]&&/*#__PURE__*/_jsxs(\"div\",{className:\"project-details\",children:[project.campaign_name&&/*#__PURE__*/_jsxs(\"div\",{className:\"project-detail-item\",children:[/*#__PURE__*/_jsx(Tag,{size:14}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Campaign: \",project.campaign_name]})]}),project.industry&&/*#__PURE__*/_jsxs(\"div\",{className:\"project-detail-item\",children:[/*#__PURE__*/_jsx(Tag,{size:14}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Industry: \",project.industry]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"project-detail-item\",children:[/*#__PURE__*/_jsx(Calendar,{size:14}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Created:\",\" \",new Date(project.created_at).toLocaleDateString()]})]}),project.description&&/*#__PURE__*/_jsx(\"p\",{className:\"project-description\",children:project.description})]})]},project.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"todo-section\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"todo-title\",children:\"To-Do List\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"todo-header\",children:[/*#__PURE__*/_jsxs(\"select\",{value:selectedProjectId,onChange:e=>setSelectedProjectId(e.target.value),className:\"project-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"No Project Selected\"}),projects.map(project=>/*#__PURE__*/_jsx(\"option\",{value:project.id,children:project.name},project.id))]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:openTodoModal,className:\"add-todo-btn\",title:\"Add new todo\",children:/*#__PURE__*/_jsx(Plus,{size:20})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"todo-list\",children:todos.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-todos\",children:[/*#__PURE__*/_jsx(CheckSquare,{size:32}),/*#__PURE__*/_jsx(\"p\",{children:\"No tasks yet. Click + to add your first to-do!\"})]}):todos.map(todo=>/*#__PURE__*/_jsxs(\"div\",{className:\"todo-item\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleToggleTodo(todo.id,todo.status),className:\"check-button\",children:todo.status===\"completed\"?/*#__PURE__*/_jsx(CheckSquare,{size:18,color:\"#28a745\"}):/*#__PURE__*/_jsx(Square,{size:18})}),/*#__PURE__*/_jsxs(\"div\",{className:\"todo-content\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"todo-text \".concat(todo.status===\"completed\"?\"completed-todo\":\"\"),children:todo.title}),todo.description&&/*#__PURE__*/_jsx(\"p\",{className:\"todo-description\",children:todo.description}),todo.project_name&&/*#__PURE__*/_jsx(\"span\",{className:\"project-tag\",children:todo.project_name})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteTodo(todo.id),className:\"delete-todo-btn\",children:/*#__PURE__*/_jsx(X,{size:16})})]},todo.id))})]})]}),(showCreateForm||editingProject)&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"modal-title\",children:editingProject?\"Edit Project\":\"Create New Project\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:editingProject?handleUpdateProject:handleCreateProject,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Project Name\",value:formData.name,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{name:e.target.value})),className:\"form-input\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Campaign Name\",value:formData.campaign,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{campaign:e.target.value})),className:\"form-input\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Industry\",value:formData.industry,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{industry:e.target.value})),className:\"form-input\"}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Description\",value:formData.description,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{description:e.target.value})),className:\"form-textarea\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-button\",children:editingProject?\"Update\":\"Create\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setShowCreateForm(false);setEditingProject(null);setFormData({name:\"\",campaign:\"\",industry:\"\",description:\"\"});},className:\"cancel-button\",children:\"Cancel\"})]})]})]})}),showTodoModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"modal-title\",children:\"Create New Todo\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCreateTodo,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Todo Title\",value:todoFormData.title,onChange:e=>setTodoFormData(_objectSpread(_objectSpread({},todoFormData),{},{title:e.target.value})),className:\"form-input\",required:true,autoFocus:true}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Description (optional)\",value:todoFormData.description,onChange:e=>setTodoFormData(_objectSpread(_objectSpread({},todoFormData),{},{description:e.target.value})),className:\"form-textarea\",rows:\"3\"}),/*#__PURE__*/_jsxs(\"select\",{value:todoFormData.priority,onChange:e=>setTodoFormData(_objectSpread(_objectSpread({},todoFormData),{},{priority:e.target.value})),className:\"form-input\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"low\",children:\"Low Priority\"}),/*#__PURE__*/_jsx(\"option\",{value:\"medium\",children:\"Medium Priority\"}),/*#__PURE__*/_jsx(\"option\",{value:\"high\",children:\"High Priority\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-button\",children:\"Create Todo\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setShowTodoModal(false);setTodoFormData({title:\"\",description:\"\",priority:\"medium\"});},className:\"cancel-button\",children:\"Cancel\"})]})]})]})})]});};export default ProjectList;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}