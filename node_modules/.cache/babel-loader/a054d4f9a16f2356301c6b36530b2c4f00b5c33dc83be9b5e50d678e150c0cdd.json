{"ast":null,"code":"import _objectSpread from\"/Users/jonathanliebowitz/Desktop/SignalDesk/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\n * Intelligence Orchestrator V3 - Clean Entity-Focused Flow\n * Simplified 3-phase intelligence pipeline optimized for entity tracking\n */class IntelligenceOrchestratorV3{constructor(){var _this$supabaseKey,_this$supabaseKey2;this.supabaseUrl=process.env.REACT_APP_SUPABASE_URL||'https://zskaxjtyuaqazydouifp.supabase.co';this.supabaseKey=process.env.REACT_APP_SUPABASE_ANON_KEY||'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inpza2F4anR5dWFxYXp5ZG91aWZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU3Nzk5MjgsImV4cCI6MjA1MTM1NTkyOH0.MJgH4j8wXJhZgfvMOpViiCyxT-BlLCIIqVMJsE_lXG0';console.log('üîß V3 Orchestrator initialized:',{url:this.supabaseUrl,hasKey:!!this.supabaseKey,keyLength:(_this$supabaseKey=this.supabaseKey)===null||_this$supabaseKey===void 0?void 0:_this$supabaseKey.length,keyPreview:((_this$supabaseKey2=this.supabaseKey)===null||_this$supabaseKey2===void 0?void 0:_this$supabaseKey2.substring(0,20))+'...'});}/**\n   * Run the complete V3 intelligence flow\n   * Phase 1: Discovery - Identify WHO and WHAT to monitor\n   * Phase 2: Gathering - Track entity actions and trends\n   * Phase 3: Synthesis - Analyze and structure for display\n   */async orchestrate(organization){console.log(\"\\uD83D\\uDE80 V3 Orchestration starting for \".concat(organization.name));try{var _discoveryData$statis,_discoveryData$statis2,_gatheringData$intell,_gatheringData$intell2,_gatheringData$intell3,_gatheringData$intell4,_gatheringData$intell5,_gatheringData$intell6,_gatheringData$intell7,_gatheringData$intell8,_gatheringData$intell9,_gatheringData$intell0,_gatheringData$intell1,_gatheringData$intell10,_gatheringData$statis,_gatheringData$statis2,_gatheringData$statis3,_synthesisData$tabs,_synthesisData$tabs$e,_synthesisData$tabs$e2,_synthesisData$alerts;// PHASE 1: DISCOVERY (Who and what to monitor)\nconsole.log('üîç Phase 1: Discovery - Identifying entities to monitor');console.log('üì° Discovery Request:',{url:\"\".concat(this.supabaseUrl,\"/functions/v1/intelligence-discovery-v3\"),organization:organization,headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(this.supabaseKey.substring(0,20),\"...\")}});const discoveryResponse=await fetch(\"\".concat(this.supabaseUrl,\"/functions/v1/intelligence-discovery-v3\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(this.supabaseKey)},body:JSON.stringify({organization})});console.log('üì° Discovery Response Status:',discoveryResponse.status);if(!discoveryResponse.ok){const errorText=await discoveryResponse.text();console.error('‚ùå Discovery Error Response:',errorText);throw new Error(\"Discovery failed: \".concat(discoveryResponse.status,\" - \").concat(errorText));}const discoveryData=await discoveryResponse.json();console.log('üì° Discovery Data:',discoveryData);if(!discoveryData.success){throw new Error(discoveryData.error||'Discovery failed');}console.log('‚úÖ Discovery complete:',{total_entities:((_discoveryData$statis=discoveryData.statistics)===null||_discoveryData$statis===void 0?void 0:_discoveryData$statis.total_entities)||0,total_topics:((_discoveryData$statis2=discoveryData.statistics)===null||_discoveryData$statis2===void 0?void 0:_discoveryData$statis2.total_topics)||0});// PHASE 2: GATHERING (Track entity actions)\nconsole.log('üì° Phase 2: Gathering - Tracking entity actions and trends');console.log('üì° Gathering Request:',{url:\"\".concat(this.supabaseUrl,\"/functions/v1/intelligence-gathering-v3\"),discovery:discoveryData.discovery,organization:organization});const gatheringResponse=await fetch(\"\".concat(this.supabaseUrl,\"/functions/v1/intelligence-gathering-v3\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(this.supabaseKey)},body:JSON.stringify({discovery:discoveryData.discovery,organization})});console.log('üì° Gathering Response Status:',gatheringResponse.status);if(!gatheringResponse.ok){const errorText=await gatheringResponse.text();console.error('‚ùå Gathering Error Response:',errorText);throw new Error(\"Gathering failed: \".concat(gatheringResponse.status,\" - \").concat(errorText));}const gatheringData=await gatheringResponse.json();console.log('üì° Gathering Data:',gatheringData);console.log('üìä Intelligence to synthesize:',{entity_actions_count:((_gatheringData$intell=gatheringData.intelligence)===null||_gatheringData$intell===void 0?void 0:(_gatheringData$intell2=_gatheringData$intell.entity_actions)===null||_gatheringData$intell2===void 0?void 0:(_gatheringData$intell3=_gatheringData$intell2.all)===null||_gatheringData$intell3===void 0?void 0:_gatheringData$intell3.length)||0,topic_trends_count:((_gatheringData$intell4=gatheringData.intelligence)===null||_gatheringData$intell4===void 0?void 0:(_gatheringData$intell5=_gatheringData$intell4.topic_trends)===null||_gatheringData$intell5===void 0?void 0:(_gatheringData$intell6=_gatheringData$intell5.all)===null||_gatheringData$intell6===void 0?void 0:_gatheringData$intell6.length)||0,has_data:!!((_gatheringData$intell7=gatheringData.intelligence)!==null&&_gatheringData$intell7!==void 0&&(_gatheringData$intell8=_gatheringData$intell7.entity_actions)!==null&&_gatheringData$intell8!==void 0&&(_gatheringData$intell9=_gatheringData$intell8.all)!==null&&_gatheringData$intell9!==void 0&&_gatheringData$intell9.length||(_gatheringData$intell0=gatheringData.intelligence)!==null&&_gatheringData$intell0!==void 0&&(_gatheringData$intell1=_gatheringData$intell0.topic_trends)!==null&&_gatheringData$intell1!==void 0&&(_gatheringData$intell10=_gatheringData$intell1.all)!==null&&_gatheringData$intell10!==void 0&&_gatheringData$intell10.length)});if(!gatheringData.success){throw new Error(gatheringData.error||'Gathering failed');}console.log('‚úÖ Gathering complete:',{actions_captured:((_gatheringData$statis=gatheringData.statistics)===null||_gatheringData$statis===void 0?void 0:_gatheringData$statis.actions_captured)||0,topics_monitored:((_gatheringData$statis2=gatheringData.statistics)===null||_gatheringData$statis2===void 0?void 0:_gatheringData$statis2.topics_monitored)||0,critical_items:((_gatheringData$statis3=gatheringData.statistics)===null||_gatheringData$statis3===void 0?void 0:_gatheringData$statis3.critical_items)||0});// PHASE 3: SYNTHESIS (Analyze with Claude 4)\nconsole.log('üß† Phase 3: Synthesis - Analyzing intelligence with Claude 4');console.log('üì° Synthesis Request:',{url:\"\".concat(this.supabaseUrl,\"/functions/v1/intelligence-synthesis-v3\"),intelligence:gatheringData.intelligence,organization:organization});const synthesisResponse=await fetch(\"\".concat(this.supabaseUrl,\"/functions/v1/intelligence-synthesis-v3\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(this.supabaseKey)},body:JSON.stringify({intelligence:gatheringData.intelligence,organization})});console.log('üì° Synthesis Response Status:',synthesisResponse.status);if(!synthesisResponse.ok){const errorText=await synthesisResponse.text();console.error('‚ùå Synthesis Error Response:',errorText);throw new Error(\"Synthesis failed: \".concat(synthesisResponse.status,\" - \").concat(errorText));}const synthesisData=await synthesisResponse.json();console.log('üì° Synthesis Data:',synthesisData);console.log('üéØ Synthesis Tabs:',synthesisData.tabs?Object.keys(synthesisData.tabs):'No tabs');// Log a sample of each tab's data\nif(synthesisData.tabs){if(synthesisData.tabs.executive){console.log('üìä Executive tab sample:',{headline:synthesisData.tabs.executive.headline,has_highlights:!!synthesisData.tabs.executive.competitive_highlight});}if(synthesisData.tabs.competitive){var _synthesisData$tabs$c;console.log('üéØ Competitive tab sample:',{actions_count:((_synthesisData$tabs$c=synthesisData.tabs.competitive.competitor_actions)===null||_synthesisData$tabs$c===void 0?void 0:_synthesisData$tabs$c.length)||0});}}if(!synthesisData.success){throw new Error(synthesisData.error||'Synthesis failed');}console.log('‚úÖ Synthesis complete:',{has_immediate_actions:((_synthesisData$tabs=synthesisData.tabs)===null||_synthesisData$tabs===void 0?void 0:(_synthesisData$tabs$e=_synthesisData$tabs.executive)===null||_synthesisData$tabs$e===void 0?void 0:(_synthesisData$tabs$e2=_synthesisData$tabs$e.immediate_actions)===null||_synthesisData$tabs$e2===void 0?void 0:_synthesisData$tabs$e2.length)>0,alert_count:((_synthesisData$alerts=synthesisData.alerts)===null||_synthesisData$alerts===void 0?void 0:_synthesisData$alerts.length)||0,tabs:Object.keys(synthesisData.tabs||{})});// Return the complete, formatted intelligence\nreturn _objectSpread(_objectSpread({success:true},synthesisData),{},{metadata:{organization:organization.name,timestamp:new Date().toISOString(),pipeline_version:'v3',phases_completed:{discovery:true,gathering:true,synthesis:true}}});}catch(error){console.error('‚ùå V3 Orchestration error:',error);console.error('Error Stack:',error.stack);console.error('Error Details:',{message:error.message,supabaseUrl:this.supabaseUrl,hasKey:!!this.supabaseKey,organization:organization});// Return error state with new comprehensive structure\nreturn{success:false,error:error.message,tabs:{executive:{headline:'Intelligence gathering failed',overview:error.message,competitive_highlight:'No data available',market_highlight:'No data available',regulatory_highlight:'No data available',media_highlight:'No data available',immediate_actions:[]},competitive:{competitor_actions:[],competitive_implications:[],pr_strategy:'',key_messages:[],do_not_say:[]},market:{market_trends:[],opportunities:[],market_implications:[],market_narrative:'',thought_leadership:[]},regulatory:{regulatory_developments:[],compliance_requirements:[],regulatory_stance:'',stakeholder_messages:[]},media:{media_coverage:[],social_trends:[],reputation_impact:'',sentiment_trend:'',narrative_risks:[],media_strategy:'',media_outreach:[],social_response:''},forward:{predictions:[],preparation_needed:[],proactive_strategy:'',prepared_statements:[]}},alerts:[],statistics:{entities_tracked:0,actions_captured:0,topics_monitored:0,critical_items:0}};}}}export default new IntelligenceOrchestratorV3();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}