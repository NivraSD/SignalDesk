{"ast":null,"code":"import _objectSpread from\"/Users/jonathanliebowitz/Desktop/SignalDesk/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{supabase}from'../../config/supabase';import{getUnifiedOrganization,getUnifiedOpportunityConfig}from'../../utils/unifiedDataLoader';import'./OpportunityModulePR.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const OpportunityModulePR=_ref=>{let{organizationId,sharedIntelligence,onIntelligenceUpdate}=_ref;const[opportunities,setOpportunities]=useState([]);const[loading,setLoading]=useState(true);const[selectedOpportunity,setSelectedOpportunity]=useState(null);useEffect(()=>{const orgData=getUnifiedOrganization();console.log('🔍 OpportunityModulePR - Organization data:',orgData);// Wait for shared intelligence to be available\nif(sharedIntelligence&&(sharedIntelligence.news||sharedIntelligence.gaps||sharedIntelligence.risks)){console.log('📊 Using shared intelligence to generate opportunities');generateOpportunitiesFromIntelligence(sharedIntelligence,orgData);}else if(orgData&&orgData.name){console.log('✅ Fetching fresh intelligence for:',orgData.name);gatherPRIntelligence(orgData);}else{console.error('⚠️ No organization data found');setOpportunities([]);setLoading(false);}},[organizationId,sharedIntelligence]);const generateOpportunitiesFromIntelligence=(intelligence,orgData)=>{console.log('🔍 Analyzing intelligence for PR opportunities...');const prOpportunities=[];// Analyze news and trends for opportunities\nif(intelligence.news&&intelligence.news.length>0){intelligence.news.forEach(item=>{// Look for competitor mentions for positioning opportunities\nif(item.competitors_mentioned&&item.competitors_mentioned.length>0){prOpportunities.push({id:\"opp-\".concat(Date.now(),\"-\").concat(Math.random()),type:'Media Positioning',urgency:'high',title:\"Media opportunity: Position against \".concat(item.competitors_mentioned[0]),description:\"\".concat(item.competitors_mentioned[0],\" is dominating the narrative on \").concat(item.topic||'this topic',\". There's a 48-hour window to insert \").concat(orgData.name,\"'s unique perspective into this conversation before media attention shifts.\"),action_plan:['Draft contrarian or complementary angle within 2 hours','Identify 10 journalists actively covering this story','Prepare 3 executive quotes with data points','Send personalized pitches to top-tier media contacts','Prepare social media amplification strategy'],source:item.title,rationale:\"Active media coverage creates immediate opportunity for earned media. Journalists are looking for fresh angles on this developing story.\"});}// Look for industry trends without our voice\nif(item.industry_relevant&&!item.company_mentioned){prOpportunities.push({id:\"opp-\".concat(Date.now(),\"-\").concat(Math.random()),type:'Thought Leadership',urgency:item.trending?'high':'medium',title:\"Thought leadership pitch: \".concat(item.topic||item.title),description:\"Major industry conversation happening without \".concat(orgData.name,\"'s voice. \").concat(item.trending?'This topic is trending NOW with':'Growing media interest with',\" multiple outlets covering the story. Perfect timing for an expert commentary or exclusive data reveal.\"),action_plan:['Develop contrarian or data-driven angle in next 4 hours','Identify top 5 publications covering this topic','Draft 800-word op-ed with exclusive insights','Create media kit with supporting data/visuals','Pitch exclusive to tier-1 publication first','Prepare LinkedIn thought leadership post for amplification'],source:item.title,rationale:\"Unclaimed thought leadership space with active media interest. First authoritative voice will own the narrative and get cited in future coverage.\"});}});}// Look for narrative gaps\nif(intelligence.gaps&&intelligence.gaps.length>0){intelligence.gaps.forEach(gap=>{prOpportunities.push({id:\"opp-\".concat(Date.now(),\"-\").concat(Math.random()),type:'Narrative Opportunity',urgency:'medium',title:gap.title||\"Fill narrative gap in \".concat(gap.area),description:gap.description||\"No major player is addressing this angle. First-mover advantage available.\",action_plan:gap.suggested_actions||['Research unique angle','Develop compelling story','Identify target media','Execute coordinated launch'],source:'Gap Analysis',rationale:gap.rationale||\"Unclaimed narrative space presents opportunity for category leadership.\"});});}// Look for crisis prevention opportunities\nif(intelligence.risks&&intelligence.risks.length>0){intelligence.risks.forEach(risk=>{if(risk.severity==='high'){prOpportunities.push({id:\"opp-\".concat(Date.now(),\"-\").concat(Math.random()),type:'Crisis Prevention',urgency:'critical',title:\"Proactive response to \".concat(risk.issue),description:\"Emerging issue detected that could impact \".concat(orgData.name,\". Proactive communication recommended.\"),action_plan:['Assess exposure immediately','Prepare holding statement','Brief crisis team','Consider proactive disclosure'],source:'Risk Detection',rationale:\"Early action can prevent narrative from cascading negatively.\"});}});}setOpportunities(prOpportunities);setLoading(false);};const gatherPRIntelligence=async orgData=>{setLoading(true);try{console.log('🎯 Gathering PR Intelligence for:',orgData.name);// Get opportunity config\nconst opportunityConfig=getUnifiedOpportunityConfig();// Call existing opportunity orchestrator with proper config structure\nconst{data,error}=await supabase.functions.invoke('opportunity-orchestrator',{body:{organization:{name:orgData.name,industry:orgData.industry||'technology'},config:_objectSpread(_objectSpread({},opportunityConfig),{},{opportunity_types:opportunityConfig.opportunity_types||{competitor_weakness:true,narrative_vacuum:true,cascade_effect:true,crisis_prevention:true,viral_moment:false}}),forceRefresh:true// Force fresh data\n}});if(!error&&data){console.log('✅ PR Intelligence gathered:',data);// Check if we got opportunities\nif(data.opportunities&&data.opportunities.length>0){// Process opportunities for PR action\nconst prOpportunities=processPROpportunities(data.opportunities,orgData);setOpportunities(prOpportunities);// Share intelligence with other modules\nif(onIntelligenceUpdate&&data.intelligence){onIntelligenceUpdate(data.intelligence);}}else{console.warn('📭 No opportunities returned from API');setOpportunities([]);}}else{console.error('❌ API error:',error);setOpportunities([]);}}catch(error){console.error('❌ Error gathering PR intelligence:',error);setOpportunities([]);}finally{setLoading(false);}};const processPROpportunities=(opportunities,orgData)=>{return opportunities.map(opp=>_objectSpread(_objectSpread({},opp),{},{id:opp.id||\"opp-\".concat(Date.now(),\"-\").concat(Math.random()),type:mapOpportunityType(opp.opportunity_type),urgency:calculateUrgency(opp),action_plan:opp.action_plan||generateActionPlan(opp.opportunity_type,orgData),rationale:opp.rationale||generateRationale(opp,orgData)}));};const mapOpportunityType=apiType=>{const typeMap={'competitor_weakness':'Media Positioning','narrative_vacuum':'Thought Leadership','cascade_effect':'Crisis Communications','crisis_prevention':'Reputation Management','viral_moment':'Trending Story','media_opportunity':'Media Pitch'};return typeMap[apiType]||'PR Opportunity';};const calculateUrgency=opportunity=>{// Calculate based on time window and impact\nif(opportunity.window_hours&&opportunity.window_hours<24)return'critical';if(opportunity.window_hours&&opportunity.window_hours<72)return'high';if(opportunity.confidence>80)return'high';if(opportunity.window_hours&&opportunity.window_hours<168)return'medium';return'low';};const generateActionPlan=(opportunityType,orgData)=>{const plans={'narrative_vacuum':['Draft thought leadership content','Identify spokesperson','Pitch to top-tier media','Amplify through owned channels'],'competitor_weakness':['Develop differentiation messaging','Brief sales and marketing teams','Prepare media outreach','Monitor competitor response'],'crisis_prevention':['Assess stakeholder impact','Prepare holding statement','Brief crisis team','Monitor sentiment closely'],'media_opportunity':['Confirm spokesperson availability','Prepare key messages','Provide supporting materials','Follow up with exclusive angles']};return plans[opportunityType]||['Assess opportunity relevance','Develop strategic approach','Execute tactical plan','Measure impact'];};const generateRationale=(opportunity,orgData)=>{return opportunity.rationale||\"This \".concat(opportunity.opportunity_type,\" opportunity allows \").concat(orgData.name,\" to shape narrative and strengthen market position.\");};const getUrgencyColor=urgency=>{const colors={critical:'#FF0000',high:'#FF6B00',medium:'#FFB800',low:'#4CAF50'};return colors[urgency]||'#6B7280';};const getUrgencyLabel=urgency=>{const labels={critical:'ACT NOW',high:'HIGH PRIORITY',medium:'MEDIUM',low:'MONITOR'};return labels[urgency]||urgency.toUpperCase();};const renderOpportunityCard=opp=>/*#__PURE__*/_jsxs(\"div\",{className:\"pr-opportunity-card\",onClick:()=>setSelectedOpportunity(opp),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"pr-opp-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"pr-opp-type\",children:opp.type}),/*#__PURE__*/_jsx(\"div\",{className:\"pr-opp-urgency\",style:{backgroundColor:getUrgencyColor(opp.urgency),color:'#FFF',fontWeight:'bold'},children:getUrgencyLabel(opp.urgency)})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"pr-opp-title\",children:opp.title}),/*#__PURE__*/_jsx(\"p\",{className:\"pr-opp-description\",children:opp.description}),opp.source&&/*#__PURE__*/_jsxs(\"div\",{className:\"pr-opp-source\",children:[\"Source: \",opp.source]})]},opp.id);const renderSelectedOpportunity=()=>{if(!selectedOpportunity)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"pr-opportunity-detail\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-button\",onClick:()=>setSelectedOpportunity(null),children:\"\\u2190 Back to Opportunities\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:selectedOpportunity.title}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-urgency\",style:{backgroundColor:getUrgencyColor(selectedOpportunity.urgency),color:'#FFF'},children:getUrgencyLabel(selectedOpportunity.urgency)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-type\",children:selectedOpportunity.type}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCCB Situation\"}),/*#__PURE__*/_jsx(\"p\",{children:selectedOpportunity.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83D\\uDCA1 Why This Matters\"}),/*#__PURE__*/_jsx(\"p\",{children:selectedOpportunity.rationale})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83C\\uDFAF Action Plan\"}),/*#__PURE__*/_jsx(\"ol\",{className:\"action-plan-list\",children:selectedOpportunity.action_plan.map((step,idx)=>/*#__PURE__*/_jsx(\"li\",{children:step},idx))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",children:\"Create Content\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",children:\"Draft Pitch\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",children:\"Find Media Contacts\"})]})]});};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"module-loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Analyzing intelligence for PR opportunities...\"})]});}return/*#__PURE__*/_jsx(\"div\",{className:\"pr-opportunity-module\",children:selectedOpportunity?renderSelectedOpportunity():/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"module-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"PR Opportunities\"}),/*#__PURE__*/_jsx(\"div\",{className:\"header-subtitle\",children:\"Real-time opportunities based on current intelligence\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"opportunities-grid\",children:opportunities.length>0?opportunities.map(opp=>renderOpportunityCard(opp)):/*#__PURE__*/_jsxs(\"div\",{className:\"no-opportunities\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"No immediate PR opportunities detected.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"hint\",children:\"Run Intelligence Hub to discover opportunities.\"})]})})]})});};export default OpportunityModulePR;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}