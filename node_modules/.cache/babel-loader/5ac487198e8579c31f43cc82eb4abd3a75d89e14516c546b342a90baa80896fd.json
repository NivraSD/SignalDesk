{"ast":null,"code":"import _objectSpread from\"/Users/jonathanliebowitz/Desktop/SignalDesk/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import axios from'axios';class PRDetectionService{constructor(){this.opportunityPatterns={funding:['raised','funding','series a','series b','investment','venture capital','seed round','valuation','capital raise','investors back'],leadership:['new ceo','new cmo','new cco','chief marketing','chief communications','leadership change','executive appointment','hired','joins as'],expansion:['expanding to','new market','international expansion','opening office','launches in','enters market','global expansion'],product:['product launch','new product','announcing','unveils','introduces','releasing','beta launch','early access'],crisis:['scandal','controversy','backlash','criticism','under fire','faces scrutiny','investigation','lawsuit','data breach'],awards:['award','recognition','honored','named to','wins','finalist','best of','top 100','industry leader'],partnership:['partnership','collaboration','strategic alliance','teams up','joint venture','partners with','agreement with'],ipo:['ipo','going public','public offering','s-1 filing','listing','stock market debut','public markets']};this.riskPatterns={negative_sentiment:['boycott','protest','outrage','angry customers','dissatisfied','complaint','terrible','worst','disappointed','furious'],regulatory:['regulatory','compliance','violation','fine','penalty','sanctions','investigation','probe','audit','subpoena'],competitor_attack:['competitor claims','rival announces','loses to','market share loss','customers switching','defecting to','better alternative'],internal_issues:['layoffs','restructuring','downsizing','cuts jobs','workforce reduction','employee dissatisfaction','turnover','exodus','resignations'],financial:['losses','revenue decline','profit warning','missed targets','bankruptcy','debt','cash flow','liquidity crisis'],reputation:['reputation damage','brand crisis','pr disaster','public relations nightmare','image problem','trust issues','credibility questioned'],security:['hack','breach','vulnerability','exposed data','security flaw','ransomware','cyber attack','compromised','leaked'],social_media:['viral complaint','twitter storm','trending negative','hashtag protest','social media backlash','influencer criticism','cancel']};this.sentimentKeywords={positive:['excellent','outstanding','impressive','innovative','breakthrough','success','achievement','milestone','record','leading'],negative:['failure','disaster','crisis','problem','issue','concern','worry','trouble','setback','challenge'],neutral:['announced','stated','reported','disclosed','revealed','confirmed','acknowledged','noted','mentioned']};}/**\n   * Analyze content for PR opportunities\n   */detectOpportunities(content){let context=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const opportunities=[];const contentLower=content.toLowerCase();// Check each opportunity category\nObject.entries(this.opportunityPatterns).forEach(_ref=>{let[category,patterns]=_ref;const matches=patterns.filter(pattern=>contentLower.includes(pattern));if(matches.length>0){const score=this.calculateOpportunityScore(matches,category,context);opportunities.push({type:'opportunity',category,confidence:score/100,matches,actionRequired:this.getOpportunityAction(category),timeframe:this.getOpportunityTimeframe(category),priority:score>80?'high':score>60?'medium':'low',score});}});return opportunities.sort((a,b)=>b.score-a.score);}/**\n   * Analyze content for PR risks\n   */detectRisks(content){let context=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const risks=[];const contentLower=content.toLowerCase();// Check each risk category\nObject.entries(this.riskPatterns).forEach(_ref2=>{let[category,patterns]=_ref2;const matches=patterns.filter(pattern=>contentLower.includes(pattern));if(matches.length>0){const severity=this.calculateRiskSeverity(matches,category,context);risks.push({type:'risk',category,severity:severity/100,matches,mitigation:this.getRiskMitigation(category),responseTime:this.getRiskResponseTime(category),priority:severity>80?'critical':severity>60?'high':'medium',severityScore:severity});}});return risks.sort((a,b)=>b.severityScore-a.severityScore);}/**\n   * Analyze sentiment of content\n   */analyzeSentiment(content){const contentLower=content.toLowerCase();let positiveCount=0;let negativeCount=0;let neutralCount=0;this.sentimentKeywords.positive.forEach(word=>{if(contentLower.includes(word))positiveCount++;});this.sentimentKeywords.negative.forEach(word=>{if(contentLower.includes(word))negativeCount++;});this.sentimentKeywords.neutral.forEach(word=>{if(contentLower.includes(word))neutralCount++;});const total=positiveCount+negativeCount+neutralCount||1;return{sentiment:positiveCount>negativeCount?'positive':negativeCount>positiveCount?'negative':'neutral',scores:{positive:positiveCount/total,negative:negativeCount/total,neutral:neutralCount/total},confidence:Math.max(positiveCount,negativeCount,neutralCount)/total};}/**\n   * Calculate opportunity score based on matches and context\n   */calculateOpportunityScore(matches,category,context){let score=matches.length*20;// Base score from match count\n// Boost score based on category importance\nconst categoryBoosts={funding:30,crisis:40,// Crisis for competitors is opportunity\nproduct:25,leadership:20,ipo:35,expansion:25,awards:15,partnership:20};score+=categoryBoosts[category]||0;// Context-based adjustments\nif(context.isCompetitor){score=category==='crisis'?score+20:score-10;}if(context.isClient){score+=15;}if(context.isTrending){score+=10;}return Math.min(100,Math.max(0,score));}/**\n   * Calculate risk severity based on matches and context\n   */calculateRiskSeverity(matches,category,context){let severity=matches.length*25;// Base severity from match count\n// Severity multipliers by category\nconst categoryMultipliers={security:2.0,regulatory:1.8,reputation:1.7,financial:1.6,negative_sentiment:1.5,social_media:1.4,internal_issues:1.3,competitor_attack:1.2};severity*=categoryMultipliers[category]||1.0;// Context-based adjustments\nif(context.isOwnBrand){severity*=1.5;}if(context.isViral){severity*=1.3;}if(context.mediaReach==='high'){severity*=1.2;}return Math.min(100,Math.max(0,severity));}/**\n   * Get recommended action for opportunity\n   */getOpportunityAction(category){const actions={funding:'Reach out with congratulations and offer PR services for announcement',leadership:'Send welcome package and schedule introduction meeting',expansion:'Propose market entry PR strategy and media relations',product:'Offer launch PR campaign and media outreach services',crisis:'Monitor competitor situation for client talking points',awards:'Amplify achievement through press release and media pitching',partnership:'Develop joint PR strategy and co-marketing opportunities',ipo:'Propose comprehensive IPO communications strategy'};return actions[category]||'Evaluate for PR opportunity';}/**\n   * Get recommended mitigation for risk\n   */getRiskMitigation(category){const mitigations={negative_sentiment:'Draft holding statement and monitor sentiment escalation',regulatory:'Prepare crisis communications plan and legal coordination',competitor_attack:'Develop competitive response strategy and key messages',internal_issues:'Create internal communications plan and media strategy',financial:'Prepare investor relations strategy and stakeholder messaging',reputation:'Activate crisis response team and media monitoring',security:'Coordinate with security team on disclosure timeline and messaging',social_media:'Deploy social listening and rapid response team'};return mitigations[category]||'Assess situation and prepare response';}/**\n   * Get response timeframe for opportunity\n   */getOpportunityTimeframe(category){const timeframes={funding:'24-48 hours',leadership:'1 week',expansion:'2-4 weeks',product:'1-2 weeks',crisis:'Immediate',awards:'48-72 hours',partnership:'1 week',ipo:'2-4 weeks'};return timeframes[category]||'1 week';}/**\n   * Get required response time for risk\n   */getRiskResponseTime(category){const responseTimes={security:'1 hour',regulatory:'2-4 hours',reputation:'2 hours',social_media:'30 minutes',negative_sentiment:'4 hours',financial:'4-6 hours',internal_issues:'24 hours',competitor_attack:'6-12 hours'};return responseTimes[category]||'24 hours';}/**\n   * Perform comprehensive PR analysis on content\n   */analyzePRSignals(content){let context=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const opportunities=this.detectOpportunities(content,context);const risks=this.detectRisks(content,context);const sentiment=this.analyzeSentiment(content);// Calculate overall PR score\nconst opportunityScore=opportunities.reduce((sum,opp)=>sum+opp.score,0)/(opportunities.length||1);const riskScore=risks.reduce((sum,risk)=>sum+risk.severityScore,0)/(risks.length||1);const prScore={overall:opportunityScore*0.6+(100-riskScore)*0.4,opportunity:opportunityScore,risk:riskScore,balance:opportunityScore-riskScore};// Determine recommended action\nlet recommendedAction='Monitor';if(prScore.balance>50){recommendedAction='Pursue Opportunity';}else if(prScore.balance<-30){recommendedAction='Mitigate Risk';}else if(opportunities.length>0&&risks.length>0){recommendedAction='Balanced Approach';}return{opportunities,risks,sentiment,prScore,recommendedAction,summary:{totalOpportunities:opportunities.length,totalRisks:risks.length,highPriorityOpportunities:opportunities.filter(o=>o.priority==='high').length,criticalRisks:risks.filter(r=>r.priority==='critical').length,dominantSentiment:sentiment.sentiment,actionableItems:opportunities.length+risks.length}};}/**\n   * Monitor multiple content sources for PR signals\n   */async monitorSources(sources,callback){const results=[];for(const source of sources){try{// In production, this would fetch real content from the source\n// For now, we'll simulate with the source description\nconst analysis=this.analyzePRSignals(source.content||source.description||'',{sourceType:source.type,sourceName:source.name,isOwnBrand:source.isOwnBrand||false,isCompetitor:source.isCompetitor||false,isClient:source.isClient||false});results.push(_objectSpread({source:source.name,timestamp:new Date().toISOString()},analysis));if(callback){callback(analysis,source);}}catch(error){console.error(\"Error analyzing source \".concat(source.name,\":\"),error);}}return results;}/**\n   * Generate PR alert based on detection\n   */generateAlert(detection,source){const alert={id:\"alert-\".concat(Date.now(),\"-\").concat(Math.random().toString(36).substr(2,9)),timestamp:new Date().toISOString(),source:source.name,type:detection.type,category:detection.category,priority:detection.priority,title:this.generateAlertTitle(detection),description:this.generateAlertDescription(detection),actions:detection.type==='opportunity'?[detection.actionRequired]:[detection.mitigation],timeframe:detection.type==='opportunity'?detection.timeframe:detection.responseTime,metadata:{matches:detection.matches,score:detection.score||detection.severityScore,confidence:detection.confidence||detection.severity}};return alert;}/**\n   * Generate alert title\n   */generateAlertTitle(detection){var _titles$detection$typ;const titles={opportunity:{funding:'💰 New Funding Opportunity Detected',leadership:'👔 Leadership Change - Engagement Opportunity',expansion:'🌍 Market Expansion Opportunity',product:'🚀 Product Launch PR Opportunity',crisis:'⚡ Competitor Crisis - Positioning Opportunity',awards:'🏆 Award Win - Amplification Opportunity',partnership:'🤝 Partnership Announcement Opportunity',ipo:'📈 IPO Communications Opportunity'},risk:{negative_sentiment:'😠 Negative Sentiment Rising',regulatory:'⚖️ Regulatory Risk Detected',competitor_attack:'🎯 Competitive Threat Identified',internal_issues:'🏢 Internal Issue Requiring Management',financial:'💸 Financial Risk Alert',reputation:'🛡️ Reputation Risk Detected',security:'🔒 Security Issue - Crisis Response Needed',social_media:'📱 Social Media Crisis Developing'}};return((_titles$detection$typ=titles[detection.type])===null||_titles$detection$typ===void 0?void 0:_titles$detection$typ[detection.category])||\"\".concat(detection.type==='opportunity'?'📍':'⚠️',\" PR \").concat(detection.type,\" Detected\");}/**\n   * Generate alert description\n   */generateAlertDescription(detection){if(detection.type==='opportunity'){return\"A \".concat(detection.priority,\" priority PR opportunity has been identified in the \").concat(detection.category,\" category. \")+\"Confidence level: \".concat(Math.round(detection.confidence*100),\"%. \")+\"Recommended response timeframe: \".concat(detection.timeframe,\".\");}else{return\"A \".concat(detection.priority,\" priority PR risk has been detected in the \").concat(detection.category,\" category. \")+\"Severity level: \".concat(Math.round(detection.severity*100),\"%. \")+\"Required response time: \".concat(detection.responseTime,\".\");}}}export default new PRDetectionService();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}