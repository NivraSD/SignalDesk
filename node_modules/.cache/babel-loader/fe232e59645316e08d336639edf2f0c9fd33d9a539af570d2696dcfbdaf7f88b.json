{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import'./RailwayV2Enhanced.css';import IntelligenceHubV8 from'./IntelligenceHubV8';import OpportunityModulePR from'./Modules/OpportunityModulePR';import ExecutionModule from'./Modules/ExecutionModule';import MemoryVaultModule from'./Modules/MemoryVaultModule';import NivStrategicAdvisor from'./Niv/NivStrategicAdvisor';import OrganizationSettings from'./OrganizationSettings';import IntelligenceSettings from'./IntelligenceSettings';import DiagnosticPanel from'./DiagnosticPanel';import{IntelligenceIcon,OpportunityIcon,ExecutionIcon,MemoryIcon,RefreshIcon,SettingsIcon}from'./Icons/NeonIcons';import{getUnifiedOrganization}from'../utils/unifiedDataLoader';import cacheManager from'../utils/cacheManager';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const RailwayV2Enhanced=()=>{var _modules$find,_modules$find2,_modules$find3;const navigate=useNavigate();const[activeModule,setActiveModule]=useState('intelligence');const[organizationData,setOrganizationData]=useState(null);const[nivMinimized,setNivMinimized]=useState(false);const[showOrgSettings,setShowOrgSettings]=useState(false);const[showIntelSettings,setShowIntelSettings]=useState(false);const[timeframe,setTimeframe]=useState('24h');const[refreshKey,setRefreshKey]=useState(0);const[sharedIntelligence,setSharedIntelligence]=useState(null);useEffect(()=>{// Check cache status on mount\nconsole.log('ðŸ“Š Cache status:',cacheManager.getCacheStatus());// Use unified data loader to get organization\nconst orgData=getUnifiedOrganization();// If no organization data exists, redirect to onboarding\nif(!orgData||!orgData.name){console.log('ðŸ“‹ No organization data found, redirecting to onboarding...');navigate('/onboarding');return;}// Ensure organization has an ID (use name as fallback ID)\nif(!orgData.id){var _orgData$name;orgData.id=((_orgData$name=orgData.name)===null||_orgData$name===void 0?void 0:_orgData$name.toLowerCase().replace(/\\s+/g,'-'))||'default-org';}console.log('ðŸ¢ RailwayV2Enhanced loaded organization:',orgData);setOrganizationData(orgData);},[navigate]);const handleNewSearch=()=>{console.log('ðŸ”„ Starting new search...');// Clear intelligence cache but keep organization\ncacheManager.startNewSearch();// Clear shared intelligence state\nsetSharedIntelligence(null);// Force a hard refresh by incrementing key\nsetRefreshKey(prev=>prev+1);// Reset to intelligence module\nsetActiveModule('intelligence');// Also clear window-level caches if they exist\nif(window.__SIGNALDESK_INTELLIGENCE__){window.__SIGNALDESK_INTELLIGENCE__=null;}};// V8.0 DEPLOYMENT MARKER - ANALYSIS-DRIVEN INTELLIGENCE\nconst deploymentVersion=\"V8.0 - ANALYSIS DRIVEN - 2025-08-25\";const modules=[{id:'intelligence',name:'Intelligence',Icon:IntelligenceIcon,color:'#00ffcc'},{id:'opportunities',name:'Opportunities',Icon:OpportunityIcon,color:'#ff00ff'},{id:'execution',name:'Execution',Icon:ExecutionIcon,color:'#00ff88'},{id:'memory',name:'Memory',Icon:MemoryIcon,color:'#8800ff'}];const renderModule=()=>{switch(activeModule){case'intelligence':// Intelligence Hub for stakeholder monitoring\nreturn/*#__PURE__*/_jsx(IntelligenceHubV8,{organization:organizationData,onIntelligenceUpdate:setSharedIntelligence});case'opportunities':return/*#__PURE__*/_jsx(OpportunityModulePR,{organizationId:organizationData===null||organizationData===void 0?void 0:organizationData.id,sharedIntelligence:sharedIntelligence,onIntelligenceUpdate:setSharedIntelligence});case'execution':return/*#__PURE__*/_jsx(ExecutionModule,{organizationId:organizationData===null||organizationData===void 0?void 0:organizationData.id});case'memory':return/*#__PURE__*/_jsx(MemoryVaultModule,{organizationId:organizationData===null||organizationData===void 0?void 0:organizationData.id});default:return/*#__PURE__*/_jsx(IntelligenceHubV8,{organization:organizationData,onIntelligenceUpdate:setSharedIntelligence});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"railway-v2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"railway-bg-animation\"}),/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:'10px',right:'10px',background:'linear-gradient(135deg, #ff00ff, #00ffcc)',color:'white',padding:'5px 15px',borderRadius:'20px',fontSize:'12px',fontWeight:'bold',zIndex:9999,boxShadow:'0 0 20px rgba(255,0,255,0.5)'},children:deploymentVersion}),/*#__PURE__*/_jsxs(\"header\",{className:\"railway-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"railway-logo\",children:/*#__PURE__*/_jsx(\"span\",{className:\"logo-text\",children:\"SIGNALDESK\"})}),/*#__PURE__*/_jsx(\"nav\",{className:\"railway-nav\",children:modules.map(module=>/*#__PURE__*/_jsxs(\"button\",{className:\"nav-button \".concat(activeModule===module.id?'active':''),onClick:()=>setActiveModule(module.id),style:{'--neon-color':module.color,'--neon-rgb':module.id==='intelligence'?'0, 255, 204':module.id==='opportunities'?'255, 0, 255':module.id==='execution'?'0, 255, 136':'136, 0, 255'},children:[/*#__PURE__*/_jsx(\"span\",{className:\"nav-icon\",children:/*#__PURE__*/_jsx(module.Icon,{size:20,color:activeModule===module.id?module.color:'rgba(255,255,255,0.7)'})}),/*#__PURE__*/_jsx(\"span\",{className:\"nav-text\",children:module.name}),/*#__PURE__*/_jsx(\"div\",{className:\"neon-glow\"})]},module.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"railway-status\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"new-search-btn\",onClick:handleNewSearch,title:\"Start New Search\",style:{background:'linear-gradient(135deg, #00ff88, #00ffcc)',color:'#000',border:'none',padding:'8px 16px',borderRadius:'20px',marginRight:'10px',fontWeight:'bold',cursor:'pointer',fontSize:'12px'},children:\"\\uD83D\\uDD04 New Search\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"org-settings-btn\",onClick:()=>setShowOrgSettings(true),title:\"Organization Settings\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"settings-icon\",children:\"\\u2699\"}),/*#__PURE__*/_jsx(\"span\",{className:\"org-name\",children:(organizationData===null||organizationData===void 0?void 0:organizationData.name)||'Select Organization'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"status-indicator active\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"railway-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"railway-content \".concat(nivMinimized?'niv-collapsed':''),children:/*#__PURE__*/_jsxs(\"div\",{className:\"module-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"module-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"module-title\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"module-icon\",children:((_modules$find=modules.find(m=>m.id===activeModule))===null||_modules$find===void 0?void 0:_modules$find.Icon)&&/*#__PURE__*/React.createElement(modules.find(m=>m.id===activeModule).Icon,{size:24,color:(_modules$find2=modules.find(m=>m.id===activeModule))===null||_modules$find2===void 0?void 0:_modules$find2.color})}),(_modules$find3=modules.find(m=>m.id===activeModule))===null||_modules$find3===void 0?void 0:_modules$find3.name,\" Hub\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"module-actions\",children:[activeModule==='intelligence'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"select\",{value:timeframe,onChange:e=>setTimeframe(e.target.value),className:\"action-select timeframe\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"24h\",children:\"24 Hours\"}),/*#__PURE__*/_jsx(\"option\",{value:\"7d\",children:\"7 Days\"}),/*#__PURE__*/_jsx(\"option\",{value:\"30d\",children:\"30 Days\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"action-btn refresh\",onClick:()=>setRefreshKey(prev=>prev+1),title:\"Refresh Intelligence\",children:[/*#__PURE__*/_jsx(RefreshIcon,{size:16,color:\"#00ff88\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Refresh\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"action-btn settings\",onClick:()=>{if(activeModule==='intelligence'){setShowIntelSettings(true);}else{setShowOrgSettings(true);}},children:[/*#__PURE__*/_jsx(SettingsIcon,{size:16,color:\"#00ffcc\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Settings\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"module-content\",children:renderModule()})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"niv-panel \".concat(nivMinimized?'minimized':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"niv-panel-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"niv-title\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"niv-icon\",children:\"\\uD83E\\uDD16\"}),/*#__PURE__*/_jsx(\"span\",{className:\"niv-name\",children:\"Niv Strategic Advisor\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"niv-minimize-btn\",onClick:()=>setNivMinimized(!nivMinimized),title:nivMinimized?'Expand':'Minimize',children:nivMinimized?'â—€':'â–¶'})]}),!nivMinimized&&/*#__PURE__*/_jsx(NivStrategicAdvisor,{organizationId:organizationData===null||organizationData===void 0?void 0:organizationData.id,activeModule:activeModule,embedded:true})]})]}),showOrgSettings&&/*#__PURE__*/_jsx(OrganizationSettings,{onClose:()=>setShowOrgSettings(false),onOrganizationChange:org=>{setOrganizationData(org);// Reload the page to refresh with new organization\nwindow.location.reload();}}),showIntelSettings&&/*#__PURE__*/_jsx(IntelligenceSettings,{onClose:()=>setShowIntelSettings(false),onSave:config=>{setShowIntelSettings(false);// Configuration is saved to localStorage, page will reload\n}}),/*#__PURE__*/_jsx(DiagnosticPanel,{})]});};export default RailwayV2Enhanced;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}