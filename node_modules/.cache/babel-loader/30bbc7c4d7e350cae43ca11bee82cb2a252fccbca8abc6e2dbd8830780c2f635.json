{"ast":null,"code":"import _objectSpread from\"/Users/jonathanliebowitz/Desktop/SignalDesk/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useRef,useEffect}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const NivChat=_ref=>{let{messages,loading,onSendMessage,onSaveAsArtifact}=_ref;const[inputValue,setInputValue]=useState('');const[savedMessages,setSavedMessages]=useState(new Set());const messagesEndRef=useRef(null);const textareaRef=useRef(null);// Debug logging\nconsole.log('ðŸŽ¯ NivChat mounted with onSaveAsArtifact:',!!onSaveAsArtifact);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};useEffect(()=>{scrollToBottom();},[messages]);const handleSubmit=e=>{e.preventDefault();const trimmedValue=inputValue.trim();if(trimmedValue&&!loading){onSendMessage(trimmedValue);setInputValue('');}};const handleKeyDown=e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSubmit(e);}};const autoResize=()=>{const textarea=textareaRef.current;if(textarea){textarea.style.height='auto';textarea.style.height=Math.min(textarea.scrollHeight,120)+'px';}};useEffect(()=>{autoResize();},[inputValue]);const chatStyles={container:{display:'flex',flexDirection:'column',height:'100%'},messagesContainer:{flex:1,overflowY:'auto',padding:'16px',display:'flex',flexDirection:'column',gap:'16px'},message:{display:'flex',flexDirection:'column',gap:'4px'},userMessage:{alignSelf:'flex-end',maxWidth:'80%'},assistantMessage:{alignSelf:'flex-start',maxWidth:'80%'},messageContent:{padding:'12px 16px',borderRadius:'12px',lineHeight:'1.5',fontSize:'14px'},userContent:{backgroundColor:'#3b82f6',color:'white'},assistantContent:{backgroundColor:'white',color:'#1e293b',border:'1px solid #e2e8f0'},inputContainer:{padding:'16px',borderTop:'1px solid #e2e8f0',backgroundColor:'white'},form:{display:'flex',gap:'8px',alignItems:'flex-end'},textarea:{flex:1,padding:'12px 16px',border:'1px solid #e2e8f0',borderRadius:'8px',fontSize:'14px',lineHeight:'1.5',resize:'none',minHeight:'44px',maxHeight:'120px',fontFamily:'inherit',outline:'none',transition:'border-color 0.2s ease'},button:{padding:'12px 16px',backgroundColor:'#3b82f6',color:'white',border:'none',borderRadius:'8px',fontSize:'14px',fontWeight:'500',cursor:'pointer',transition:'all 0.2s ease',minWidth:'60px',height:'44px',display:'flex',alignItems:'center',justifyContent:'center'},buttonDisabled:{backgroundColor:'#94a3b8',cursor:'not-allowed'},loadingDots:{display:'flex',gap:'2px'},dot:{width:'4px',height:'4px',borderRadius:'50%',backgroundColor:'#64748b',animation:'pulse 1.5s ease-in-out infinite'},timestamp:{fontSize:'12px',color:'#64748b',marginTop:'4px'},userTimestamp:{textAlign:'right'},assistantTimestamp:{textAlign:'left'},saveButton:{marginTop:'8px',padding:'6px 12px',backgroundColor:'#10b981',color:'white',border:'none',borderRadius:'6px',fontSize:'13px',fontWeight:'500',cursor:'pointer',transition:'all 0.2s ease',display:'inline-flex',alignItems:'center',gap:'6px'},savedIndicator:{marginTop:'8px',padding:'6px 12px',backgroundColor:'#f0fdf4',color:'#10b981',border:'1px solid #86efac',borderRadius:'6px',fontSize:'13px',fontWeight:'500',display:'inline-flex',alignItems:'center',gap:'6px'}};const formatTime=timestamp=>{return new Date(timestamp).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});};// Check if a message contains substantial content worth saving\nconst isSubstantialContent=content=>{if(!content)return false;// Check for strategic/tactical value indicators\nconst strategicPhrases=['strategic framework','tactical approach','comprehensive plan','actionable strategy','here\\'s how','implementation','step-by-step','action plan','campaign','strategy','approach','framework','methodology','blueprint','roadmap','timeline','objectives','kpis','metrics'];const lowerContent=content.toLowerCase();const hasStrategicValue=strategicPhrases.some(phrase=>lowerContent.includes(phrase));// Check for structural indicators\nconst hasMultipleParagraphs=content.split('\\n\\n').length>1;const hasListItems=content.includes('â€¢')||content.includes('-')||/\\d+\\./.test(content);const hasStructure=content.includes(':')&&content.length>200;const isLongEnough=content.length>250;// Check for actionable content\nconst hasActionableContent=/\\b(step \\d|phase \\d|first|second|third|next|then|finally)\\b/i.test(content);const result=hasStrategicValue||hasMultipleParagraphs&&isLongEnough||hasListItems&&hasStructure||hasActionableContent;console.log('ðŸ“Š Content analysis:',{length:content.length,hasStrategicValue,hasMultipleParagraphs,hasListItems,hasStructure,isLongEnough,hasActionableContent,result});return result;};const handleSaveAsArtifact=(message,index)=>{if(onSaveAsArtifact){// Determine a title based on content\nlet title='Strategic Insight';const lowerContent=message.content.toLowerCase();// More intelligent title detection\nif(lowerContent.includes('media list')||lowerContent.includes('journalist')){title='Media List Strategy';}else if(lowerContent.includes('press release')||lowerContent.includes('announcement')){title='Press Release';}else if(lowerContent.includes('social media')||lowerContent.includes('twitter')||lowerContent.includes('linkedin')){title='Social Media Strategy';}else if(lowerContent.includes('crisis')||lowerContent.includes('damage control')){title='Crisis Management Plan';}else if(lowerContent.includes('campaign')&&lowerContent.includes('launch')){title='Launch Campaign Strategy';}else if(lowerContent.includes('opportunity')||lowerContent.includes('opportunities')){title='Opportunity Analysis';}else if(lowerContent.includes('competitive')||lowerContent.includes('competitor')){title='Competitive Analysis';}else if(lowerContent.includes('framework')||lowerContent.includes('methodology')){title='Strategic Framework';}else if(lowerContent.includes('action plan')||lowerContent.includes('tactical')){title='Tactical Action Plan';}else if(lowerContent.includes('message')||lowerContent.includes('talking')){title='Key Messaging';}else if(lowerContent.includes('faq')||lowerContent.includes('question')){title='FAQ Document';}else if(lowerContent.includes('strategy')){title='PR Strategy';}else if(lowerContent.includes('plan')){title='Strategic Plan';}// Create artifact from the message\nconst artifact={id:\"artifact_\".concat(Date.now(),\"_\").concat(Math.random().toString(36).substr(2,9)),type:'document',title:title,created:new Date().toISOString(),content:{text:message.content,formatted:true}};onSaveAsArtifact(artifact);setSavedMessages(prev=>new Set(prev).add(index));}};const LoadingMessage=()=>/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.message),chatStyles.assistantMessage),children:/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.messageContent),chatStyles.assistantContent),children:/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.loadingDots,children:[/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.dot),{},{animationDelay:'0s'})}),/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.dot),{},{animationDelay:'0.2s'})}),/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.dot),{},{animationDelay:'0.4s'})})]})})});return/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.container,children:[/*#__PURE__*/_jsx(\"style\",{children:\"\\n          @keyframes pulse {\\n            0%, 80%, 100% {\\n              opacity: 0.3;\\n            }\\n            40% {\\n              opacity: 1;\\n            }\\n          }\\n          \\n          .niv-chat-textarea:focus {\\n            border-color: #3b82f6 !important;\\n            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\\n          }\\n          \\n          .niv-chat-button:hover:not(:disabled) {\\n            background-color: #2563eb !important;\\n          }\\n          \\n          .niv-chat-button:active:not(:disabled) {\\n            transform: translateY(1px);\\n          }\\n        \"}),/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.messagesContainer,children:[messages.map((message,index)=>/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.message),message.role==='user'?chatStyles.userMessage:chatStyles.assistantMessage),children:[/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.messageContent),message.role==='user'?chatStyles.userContent:chatStyles.assistantContent),children:message.content}),/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},chatStyles.timestamp),message.role==='user'?chatStyles.userTimestamp:chatStyles.assistantTimestamp),children:formatTime(message.timestamp||Date.now())}),(_message$content=>{const shouldShowSave=message.role==='assistant'&&isSubstantialContent(message.content)&&onSaveAsArtifact;console.log('ðŸ” Save button check for message',index,{role:message.role,contentLength:(_message$content=message.content)===null||_message$content===void 0?void 0:_message$content.length,isSubstantial:message.role==='assistant'?isSubstantialContent(message.content):false,hasHandler:!!onSaveAsArtifact,shouldShow:shouldShowSave});return shouldShowSave;})()&&(savedMessages.has(index)?/*#__PURE__*/_jsxs(\"div\",{style:chatStyles.savedIndicator,children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2713\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Saved to Workspace\"})]}):/*#__PURE__*/_jsxs(\"button\",{style:chatStyles.saveButton,onClick:()=>handleSaveAsArtifact(message,index),onMouseEnter:e=>e.target.style.backgroundColor='#059669',onMouseLeave:e=>e.target.style.backgroundColor='#10b981',children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCBE\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Save to Workspace\"})]}))]},index)),loading&&/*#__PURE__*/_jsx(LoadingMessage,{}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsx(\"div\",{style:chatStyles.inputContainer,children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,style:chatStyles.form,children:[/*#__PURE__*/_jsx(\"textarea\",{ref:textareaRef,value:inputValue,onChange:e=>setInputValue(e.target.value),onKeyDown:handleKeyDown,placeholder:\"Ask me to create media lists, press releases, strategic plans, or anything else...\",style:chatStyles.textarea,className:\"niv-chat-textarea\",disabled:loading}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!inputValue.trim()||loading,style:_objectSpread(_objectSpread({},chatStyles.button),!inputValue.trim()||loading?chatStyles.buttonDisabled:{}),className:\"niv-chat-button\",children:loading?'...':'Send'})]})})]});};export default NivChat;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}